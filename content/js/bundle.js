!function t(n,i,e){function r(o,u){if(!i[o]){if(!n[o]){var h="function"==typeof require&&require;if(!u&&h)return h(o,!0);if(s)return s(o,!0);var a=new Error("Cannot find module '"+o+"'");throw a.code="MODULE_NOT_FOUND",a}var c=i[o]={exports:{}};n[o][0].call(c.exports,function(t){var i=n[o][1][t];return r(i?i:t)},c,c.exports,t,n,i,e)}return i[o].exports}for(var s="function"==typeof require&&require,o=0;o<e.length;o++)r(e[o]);return r}({1:[function(t,n,i){(function(t){function n(t,n){for(var i=0,e=t.length-1;e>=0;e--){var r=t[e];"."===r?t.splice(e,1):".."===r?(t.splice(e,1),i++):i&&(t.splice(e,1),i--)}if(n)for(;i--;i)t.unshift("..");return t}function e(t,n){if(t.filter)return t.filter(n);for(var i=[],e=0;e<t.length;e++)n(t[e],e,t)&&i.push(t[e]);return i}var r=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,s=function(t){return r.exec(t).slice(1)};i.resolve=function(){for(var i="",r=!1,s=arguments.length-1;s>=-1&&!r;s--){var o=s>=0?arguments[s]:t.cwd();if("string"!=typeof o)throw new TypeError("Arguments to path.resolve must be strings");o&&(i=o+"/"+i,r="/"===o.charAt(0))}return i=n(e(i.split("/"),function(t){return!!t}),!r).join("/"),(r?"/":"")+i||"."},i.normalize=function(t){var r=i.isAbsolute(t),s="/"===o(t,-1);return t=n(e(t.split("/"),function(t){return!!t}),!r).join("/"),t||r||(t="."),t&&s&&(t+="/"),(r?"/":"")+t},i.isAbsolute=function(t){return"/"===t.charAt(0)},i.join=function(){var t=Array.prototype.slice.call(arguments,0);return i.normalize(e(t,function(t,n){if("string"!=typeof t)throw new TypeError("Arguments to path.join must be strings");return t}).join("/"))},i.relative=function(t,n){function e(t){for(var n=0;n<t.length&&""===t[n];n++);for(var i=t.length-1;i>=0&&""===t[i];i--);return n>i?[]:t.slice(n,i-n+1)}t=i.resolve(t).substr(1),n=i.resolve(n).substr(1);for(var r=e(t.split("/")),s=e(n.split("/")),o=Math.min(r.length,s.length),u=o,h=0;o>h;h++)if(r[h]!==s[h]){u=h;break}for(var a=[],h=u;h<r.length;h++)a.push("..");return a=a.concat(s.slice(u)),a.join("/")},i.sep="/",i.delimiter=":",i.dirname=function(t){var n=s(t),i=n[0],e=n[1];return i||e?(e&&(e=e.substr(0,e.length-1)),i+e):"."},i.basename=function(t,n){var i=s(t)[2];return n&&i.substr(-1*n.length)===n&&(i=i.substr(0,i.length-n.length)),i},i.extname=function(t){return s(t)[3]};var o="b"==="ab".substr(-1)?function(t,n,i){return t.substr(n,i)}:function(t,n,i){return 0>n&&(n=t.length+n),t.substr(n,i)}}).call(this,t("_process"))},{_process:2}],2:[function(t,n,i){function e(){c=!1,u.length?a=u.concat(a):f=-1,a.length&&r()}function r(){if(!c){var t=setTimeout(e);c=!0;for(var n=a.length;n;){for(u=a,a=[];++f<n;)u&&u[f].run();f=-1,n=a.length}u=null,c=!1,clearTimeout(t)}}function s(t,n){this.fun=t,this.array=n}function o(){}var u,h=n.exports={},a=[],c=!1,f=-1;h.nextTick=function(t){var n=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)n[i-1]=arguments[i];a.push(new s(t,n)),1!==a.length||c||setTimeout(r,0)},s.prototype.run=function(){this.fun.apply(null,this.array)},h.title="browser",h.browser=!0,h.env={},h.argv=[],h.version="",h.versions={},h.on=o,h.addListener=o,h.once=o,h.off=o,h.removeListener=o,h.removeAllListeners=o,h.emit=o,h.binding=function(t){throw new Error("process.binding is not supported")},h.cwd=function(){return"/"},h.chdir=function(t){throw new Error("process.chdir is not supported")},h.umask=function(){return 0}},{}],3:[function(t,n,i){var e,r,s,o,u,h,a,c=function(t,n){return function(){return t.apply(n,arguments)}};h=t("path"),s=t("./types"),a=t("./util"),r=t("./input"),o=t("./unit"),e=t("./brain/human"),u=function(){function t(t){var n,i,u,h,a,f,l,p,d,v;for(this.size=null!=t?t:32,this.render=c(this.render,this),this.size2=this.size*this.size,this.field=new Uint8Array(this.size2),this.dismap=new Int32Array(this.size2),this.plInfmap=new Float32Array(this.size2),this.enInfmap=new Float32Array(this.size2),l="11111111111111111111111111111111\r\n10000000000000001000000000000001\r\n10101000000000001000000000001101\r\n10000000000100000000000010000101\r\n10101000000100000000000010000001\r\n10000000000000001000000110000001\r\n10000000000000001000111110000001\r\n10000001101100000000001111110001\r\n10000001000100001000000110000001\r\n10000000010000001000000100000001\r\n10000001000100001000000100000001\r\n10000001101100001011000000111111\r\n10000000000000001011100000000001\r\n10000000000000011011100000000001\r\n10000000000000011000000000000001\r\n10111110111111111110000000000001\r\n10000000000001111111111101111101\r\n10000000000000011000000000000001\r\n10000000000111011000000000000001\r\n10000000000111010000000000000001\r\n11111100000011010000110110000001\r\n10000000100000010000100010000001\r\n10000000100000010000001000000001\r\n10000001100000010000100010000001\r\n10001111110000000000110110000001\r\n10000011111100010000000000000001\r\n10000001100000010000000000000001\r\n10000001000000000000100000010101\r\n10100001000000000000100000000001\r\n10110000000000010000000000010101\r\n10000000000000010000000000000001\r\n11111111111111111111111111111111",l=l.replace(/\r*\n/g,""),p=this.field,i=u=0,a=p.length;a>u;i=++u)v=p[i],this.field[i]=parseInt(l.charAt(i));for(d=this.dismap,i=h=0,f=d.length;f>h;i=++h)v=d[i],this.dismap[i]=0===this.field[i]?1:-1;this.input=new r,n=new e(this.input),this.player=new o(this.size/2,this.size/2,s.UNIT.PLAYER,n)}return t.prototype.hitCheck=function(t,n){var i,e,r,s;return.5>t||.5>n?-2:t>this.size-.5||n>this.size-.5?-2:(e=Math.floor(t-.5)+this.size*Math.floor(n-.5),r=t-.5-Math.floor(t-.5),s=n-.5-Math.floor(n-.5),1e-4>r&&(r=0),1e-4>s&&(s=0),i=[this.dismap[e],this.dismap[e+1],this.dismap[e+this.size],this.dismap[e+this.size+1]],(1-r)*(1-s)*i[0]+(1-r)*s*i[2]+r*(1-s)*i[1]+r*s*i[3])},t.prototype.fix=function(t){var n,i,e,r,s,o,u;for(s=t.getCollider(),u=[],i=0,e=s.length;e>i;i++)r=s[i],n=this.hitCheck(r.x,r.y),0>n?(o=(t.ang+180)*Math.PI/180,t.pos.x-=n*Math.cos(o),t.pos.y-=n*Math.sin(o),u.push(t.vel=0)):u.push(void 0);return u},t.prototype.drawGrid=function(t,n){var i,e,r,s,o,u,h;for(t.strokeStyle="rgb(92, 92, 92)",u=i=0,r=this.size;r>=0?r>i:i>r;u=r>=0?++i:--i)t.beginPath(),t.moveTo(u*this.gridSize,0),t.lineTo(u*this.gridSize,n),t.stroke();for(o=[],h=e=0,s=this.size;s>=0?s>e:e>s;h=s>=0?++e:--e)t.beginPath(),t.moveTo(0,h*this.gridSize),t.lineTo(n,h*this.gridSize),o.push(t.stroke());return o},t.prototype.drawField=function(t){var n,i,e,r,s,o,u,h,a;for(t.strokeStyle="rgb(0, 255, 128)",o=this.dismap,i=e=0,r=o.length;r>e;i=++e)if(u=o[i],h=i%this.size,a=i/this.size|0,!(h>this.size-2)){if(a>this.size-2)break;n=[this.dismap[i],this.dismap[i+1],this.dismap[i+this.size],this.dismap[i+this.size+1]],s=[],n[0]*n[1]<0&&s.push({x:h+.5,y:a}),n[0]*n[2]<0&&s.push({x:h,y:a+.5}),n[1]*n[3]<0&&s.push({x:h+1,y:a+.5}),n[2]*n[3]<0&&s.push({x:h+.5,y:a+1}),2===s.length&&(t.moveTo((s[0].x+.5)*this.gridSize,(s[0].y+.5)*this.gridSize),t.lineTo((s[1].x+.5)*this.gridSize,(s[1].y+.5)*this.gridSize))}return t.stroke()},t.prototype.drawUnit=function(t,n){var i,e,r,s,o,u,h,a,c,f;return t.strokeStyle="rgb(0, 255, 255)",t.fillStyle="rgb(0, 0, 0)",t.beginPath(),t.lineWidth=2,i=n.pos.x*this.gridSize,e=n.pos.y*this.gridSize,f=n.size*this.gridSize,c=n.ang*Math.PI/180,r=i+f*Math.cos(c),s=e+f*Math.sin(c),c=(n.ang-150)*Math.PI/180,o=i+f*Math.cos(c),u=e+f*Math.sin(c),c=(n.ang+150)*Math.PI/180,h=i+f*Math.cos(c),a=e+f*Math.sin(c),c=n.ang*Math.PI/180,t.moveTo(r,s),t.lineTo(o,u),t.lineTo(i,e),t.lineTo(h,a),t.lineTo(r,s),t.fill(),t.stroke()},t.prototype.update=function(){return this.player.update(),this.fix(this.player)},t.prototype.render=function(t,n){return this.gridSize=n/this.size,this.drawField(t),this.drawUnit(t,this.player)},t}(),n.exports=u},{"./brain/human":6,"./input":7,"./types":9,"./unit":10,"./util":11,path:1}],4:[function(t,n,i){n.exports={MOVE:{TOP:0,BOTTOM:1,LEFT:2,RIGHT:3},ATTACK:{AIM:7,FOWARD:8}}},{}],5:[function(t,n,i){var e;e=function(){function t(){}return t.prototype.update=function(t){},t}(),n.exports=e},{}],6:[function(t,n,i){var e,r,s,o=function(t,n){function i(){this.constructor=t}for(var e in n)u.call(n,e)&&(t[e]=n[e]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t},u={}.hasOwnProperty;r=t("../brain"),e=t("../actions"),s=function(t){function n(t){this.input=t,n.__super__.constructor.call(this)}return o(n,t),n.prototype.update=function(t){var i;return n.__super__.update.call(this,t),i=[],this.input.keys.up&&i.push(e.MOVE.TOP),this.input.keys.down&&i.push(e.MOVE.BOTTOM),this.input.keys.right&&i.push(e.MOVE.RIGHT),this.input.keys.left&&i.push(e.MOVE.LEFT),this.input.keys.z&&i.push(e.ATTACK.AIM),i},n}(r),n.exports=s},{"../actions":4,"../brain":5}],7:[function(t,n,i){var e,r=[].indexOf||function(t){for(var n=0,i=this.length;i>n;n++)if(n in this&&this[n]===t)return n;return-1},s={}.hasOwnProperty;e=function(){function t(t){var n,i,e,o,u,h,a,c,f;this.domElement=null!=t?t:document,this.keys={},this.listener={},this.keyMap={8:"backspace",13:"enter",16:"shift",17:"ctrl",18:"alt",27:"esc",32:"space",37:"left",38:"up",39:"right",40:"down"},o=function(t){return function(n,i){return{key:t.keyMap[n]||String.fromCharCode(n).toLowerCase(),status:i}}}(this),i=Bacon.fromEventTarget(this.domElement,"keydown").map(function(t){return function(n){return o.call(t,n.keyCode,!0)}}(this)),e=Bacon.fromEventTarget(this.domElement,"keyup").map(function(t){return function(n){return o.call(t,n.keyCode,!1)}}(this)),i.merge(e).filter(function(t){var n;return n=t.key.charCodeAt(0),n>47&&58>n||n>96&&123>n}).onValue(function(t){return function(n){var i;return t.keys[n.key]=n.status,n.status&&null!=(i=t.listener[n.key])?i.forEach(function(t){return t()}):void 0}}(this)),n=[1,2],u=function(t){return function(i){var e;return e={},n.forEach(function(t){return e[t]=[]}),Bacon.fromEventTarget(t.domElement,i).filter(function(t){var i;return i=t.button,r.call(n,i)>=0}).onValue(function(t){return e[t.button].forEach(function(n){return n(t.clientX,t.clientY)})}),[function(t,n){var i;return null!=(i=e[t])?i.push(n):void 0},function(t,n){return _.remove(e[t],function(t){return null!=n?t===n:!0})}]}}(this),h=u("mousedown"),this.onMouseDown=h[0],this.offMouseDown=h[1],a=u("mouseup"),this.onMouseUp=a[0],this.offMouseUp=a[1],c=_.transform(u("dblclick"),function(t,n){return t.push(n.bind(this,1))}),this.onDoubleClick=c[0],this.offDoubleClick=c[1],f=function(t){return function(){var i,e,r,o;return e={},i={},n.forEach(function(t){return i[t]=!1,e[t]=[]}),r=Bacon.fromEventTarget(t.domElement,"mousedown").map(function(t){return[t.button,!0]}),o=Bacon.fromEventTarget(t.domElement,"mouseup").map(function(t){return[t.button,!1]}),r.merge(o).onValue(function(t){return null!=i[t[0]]?i[t[0]]=t[1]:void 0}),Bacon.fromEventTarget(t.domElement,"mousemove").onValue(function(t){var n,r,o;r=[];for(n in e)s.call(e,n)&&(o=e[n],r.push(o.forEach(function(e){return i[n]?e(t.clientX,t.clientY):void 0})));return r}),[function(t,n){var i;return null!=(i=e[t])?i.push(n):void 0},function(t,n){return _.remove(e[t],function(t){return null!=n?t===n:!0})}]}}(this)(),this.onMouseMove=f[0],this.offMouseMove=f[1],this.offAll=function(t){return function(){var i,e,r,o;n.forEach(function(n){return t.offMouseDown(n),t.offMouseUp(n),t.offMouseMove(n)}),t.offDoubleClick(),e=t.listener,r=[];for(i in e)s.call(e,i)&&(o=e[i],r.push(t.off(i)));return r}}(this)}return t.prototype.on=function(t,n){return this.listener[t]?this.listener[t].push(n):this.listener[t]=[n]},t.prototype.off=function(t,n){return null==n&&(n=allremove),_.remove(this.listener[t],function(t){return t===n})},t}(),n.exports=e},{}],8:[function(t,n,i){"use strict";var e,r,s;r=t("./view"),s=t("./World"),e=function(){function t(){this.view=new r,this.world=new s}return t.prototype.loop=function(){return requestAnimationFrame(function(t){return function(){return t.loop()}}(this)),this.world.update(),this.view.render(this.world.render)},t}(),$(function(){return(new e).loop()})},{"./World":3,"./view":12}],9:[function(t,n,i){n.exports={UNIT:{PLAYER:0}}},{}],10:[function(t,n,i){var e,r,s;r=t("./types"),e=t("./actions"),s=function(){function t(t,n,i,e){this.type=i,this.brain=e,this.pos={x:t,y:n},this.ang=0,this.shotang=0,this.size=.2,this.vel=0}return t.prototype.getCollider=function(){var t,n;return t=[],n=this.ang*Math.PI/180,t.push({x:this.pos.x+this.size*Math.cos(n),y:this.pos.y+this.size*Math.sin(n)}),t},t.prototype.action=function(t){var n,i,r,s,o,u,h;for(u=0,i=!1,h=!1,r=[void 0,-90,90,void 0,180,-135,135,180,0,-45,45,0,void 0,-90,90,void 0],s=0,o=t.length;o>s;s++)switch(n=t[s]){case e.MOVE.TOP:u+=1;break;case e.MOVE.BOTTOM:u+=2;break;case e.MOVE.LEFT:u+=4;break;case e.MOVE.RIGHT:u+=8;break;case e.ATTACK.AIM:i=!0,h=!0;break;case e.ATTACK.FOWARD:h=!0}return null!=r[u]?(this.ang=r[u],this.vel=i?.04:.07):this.vel=0,h?0:void 0},t.prototype.update=function(){var t;return this.action(this.brain.update(this)),t=this.ang*Math.PI/180,this.pos.x+=this.vel*Math.cos(t),this.pos.y+=this.vel*Math.sin(t),this.vel=.7*this.vel,this.vel*this.vel<1e-4?this.vel=0:void 0},t.prototype.draw=function(t){var n,i,e,r,s,o,u;return t.strokeStyle="rgb(0, 92, 192)",t.beginPath(),u=this.ang*Math.PI/180,n=this.pos.x+this.size*Math.cos(u),i=this.pos.y+this.size*Math.sin(u),u=(this.ang-60)*Math.PI/180,e=this.pos.x+this.size*Math.cos(u),r=this.pos.y+this.size*Math.sin(u),u=(this.ang+60)*Math.PI/180,s=this.pos.x+this.size*Math.cos(u),o=this.pos.y+this.size*Math.sin(u),u=this.ang*Math.PI/180,t.moveTo(n,i),t.lineTo(e,r),t.lineTo(this.pos.x,this.pos.y),t.lineTo(s,o),t.lineTo(n,i),t.stroke()},t}(),n.exports=s},{"./actions":4,"./types":9}],11:[function(t,n,i){var e;e=function(){function t(){}return t.rand=function(t){return Math.floor(Math.random()*t)},t.randf=function(t){return Math.random()*t},t.randRange=function(t,n){return Math.floor(Math.random()*(n-t+1))+t},t.randArray=function(t){return t[Math.floor(Math.random()*t.length)]},t}(),n.exports=e},{}],12:[function(t,n,i){var e;e=function(){function t(){this.canvas=document.getElementById("view"),this.backcanvas=document.createElement("canvas"),this.backcanvas.style.visibility="hidden",this.ctx=this.canvas.getContext("2d"),this.backctx=this.backcanvas.getContext("2d"),this.update(),$(window).resize(function(t){return function(){return t.update()}}(this)),this.stats=new Stats,this.stats.setMode(0),this.stats.domElement.style.position="absolute",this.stats.domElement.style.left="0px",this.stats.domElement.style.top="0px",$(document.body).append(this.stats.domElement)}return t.prototype.update=function(){var t,n;return n=window.innerWidth,t=window.innerHeight,this.viewSize=Math.min(n,t),this.canvas.width=this.viewSize,this.canvas.height=this.viewSize,this.backcanvas.width=this.viewSize,this.backcanvas.height=this.viewSize},t.prototype.render=function(t){return this.stats.begin(),this.backctx.clearRect(0,0,this.backcanvas.width,this.backcanvas.height),this.backctx.fillStyle="black",this.backctx.fillRect(0,0,this.viewSize,this.viewSize),this.backctx.fill(),t(this.backctx,this.viewSize),this.ctx.drawImage(this.backcanvas,0,0),this.stats.end()},t}(),n.exports=e},{}]},{},[8]);
//# sourceMappingURL=bundle.js.map