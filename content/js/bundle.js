!function t(n,e,i){function r(o,u){if(!e[o]){if(!n[o]){var a="function"==typeof require&&require;if(!u&&a)return a(o,!0);if(s)return s(o,!0);var h=new Error("Cannot find module '"+o+"'");throw h.code="MODULE_NOT_FOUND",h}var c=e[o]={exports:{}};n[o][0].call(c.exports,function(t){var e=n[o][1][t];return r(e?e:t)},c,c.exports,t,n,e,i)}return e[o].exports}for(var s="function"==typeof require&&require,o=0;o<i.length;o++)r(i[o]);return r}({1:[function(t,n,e){(function(t){function n(t,n){for(var e=0,i=t.length-1;i>=0;i--){var r=t[i];"."===r?t.splice(i,1):".."===r?(t.splice(i,1),e++):e&&(t.splice(i,1),e--)}if(n)for(;e--;e)t.unshift("..");return t}function i(t,n){if(t.filter)return t.filter(n);for(var e=[],i=0;i<t.length;i++)n(t[i],i,t)&&e.push(t[i]);return e}var r=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,s=function(t){return r.exec(t).slice(1)};e.resolve=function(){for(var e="",r=!1,s=arguments.length-1;s>=-1&&!r;s--){var o=s>=0?arguments[s]:t.cwd();if("string"!=typeof o)throw new TypeError("Arguments to path.resolve must be strings");o&&(e=o+"/"+e,r="/"===o.charAt(0))}return e=n(i(e.split("/"),function(t){return!!t}),!r).join("/"),(r?"/":"")+e||"."},e.normalize=function(t){var r=e.isAbsolute(t),s="/"===o(t,-1);return t=n(i(t.split("/"),function(t){return!!t}),!r).join("/"),t||r||(t="."),t&&s&&(t+="/"),(r?"/":"")+t},e.isAbsolute=function(t){return"/"===t.charAt(0)},e.join=function(){var t=Array.prototype.slice.call(arguments,0);return e.normalize(i(t,function(t,n){if("string"!=typeof t)throw new TypeError("Arguments to path.join must be strings");return t}).join("/"))},e.relative=function(t,n){function i(t){for(var n=0;n<t.length&&""===t[n];n++);for(var e=t.length-1;e>=0&&""===t[e];e--);return n>e?[]:t.slice(n,e-n+1)}t=e.resolve(t).substr(1),n=e.resolve(n).substr(1);for(var r=i(t.split("/")),s=i(n.split("/")),o=Math.min(r.length,s.length),u=o,a=0;o>a;a++)if(r[a]!==s[a]){u=a;break}for(var h=[],a=u;a<r.length;a++)h.push("..");return h=h.concat(s.slice(u)),h.join("/")},e.sep="/",e.delimiter=":",e.dirname=function(t){var n=s(t),e=n[0],i=n[1];return e||i?(i&&(i=i.substr(0,i.length-1)),e+i):"."},e.basename=function(t,n){var e=s(t)[2];return n&&e.substr(-1*n.length)===n&&(e=e.substr(0,e.length-n.length)),e},e.extname=function(t){return s(t)[3]};var o="b"==="ab".substr(-1)?function(t,n,e){return t.substr(n,e)}:function(t,n,e){return 0>n&&(n=t.length+n),t.substr(n,e)}}).call(this,t("_process"))},{_process:2}],2:[function(t,n,e){function i(){c=!1,u.length?h=u.concat(h):p=-1,h.length&&r()}function r(){if(!c){var t=setTimeout(i);c=!0;for(var n=h.length;n;){for(u=h,h=[];++p<n;)u&&u[p].run();p=-1,n=h.length}u=null,c=!1,clearTimeout(t)}}function s(t,n){this.fun=t,this.array=n}function o(){}var u,a=n.exports={},h=[],c=!1,p=-1;a.nextTick=function(t){var n=new Array(arguments.length-1);if(arguments.length>1)for(var e=1;e<arguments.length;e++)n[e-1]=arguments[e];h.push(new s(t,n)),1!==h.length||c||setTimeout(r,0)},s.prototype.run=function(){this.fun.apply(null,this.array)},a.title="browser",a.browser=!0,a.env={},a.argv=[],a.version="",a.versions={},a.on=o,a.addListener=o,a.once=o,a.off=o,a.removeListener=o,a.removeAllListeners=o,a.emit=o,a.binding=function(t){throw new Error("process.binding is not supported")},a.cwd=function(){return"/"},a.chdir=function(t){throw new Error("process.chdir is not supported")},a.umask=function(){return 0}},{}],3:[function(t,n,e){var i,r,s,o,u,a,h,c;h=t("path"),c=t("./util"),r=t("./input"),u=t("./unit"),o=t("./team"),i=t("./brain/human"),s=t("./brain/standard"),a=function(){function t(t,n,e){var a,h,c,p,l,f,d,v,m,y,g,w,b,z,M,x,T,E,k,I,P,O,A,C,S,_;for(this.container=t,this.viewsize=n,this.size=null!=e?e:32,this.input=new r,this.size2=this.size*this.size,this.gridSize=this.viewsize/this.size,this.field=new Uint8Array(this.size2),this.dismap=new Int32Array(this.size2),this.plInfmap=new Float32Array(this.size2),this.enInfmap=new Float32Array(this.size2),T=1,this.team=[],h=[{},{}],z="11111111111111111111111111111111\r\n10000000000000001000000000000001\r\n10303000000000001000000000001101\r\n10060000000100000000000010000101\r\n10303000000100000000000010000001\r\n10000000000000001000000110000001\r\n10000000000000001000111111000001\r\n10000003303300000000001111110001\r\n10000003000300001000000110000001\r\n10000000020000001000000100000001\r\n10000003000300001000000100000001\r\n10000003303300001011000000111111\r\n10000000000000001011100000000001\r\n10000000000000011011100000000001\r\n10000000000000011000000000000001\r\n10111110111111111110000000000001\r\n10000000000001111111111101111101\r\n10000000000000011000000000000001\r\n10000000000111011000000000000001\r\n10000000000111010000000000000001\r\n11111100000011010000550550000001\r\n10000000100000010000500050000001\r\n10000000100000010000004000000001\r\n10000001100000010000500050000001\r\n10001111110000000000550550000001\r\n10000011111100010000000000000001\r\n10000001100000010000000000000001\r\n10000001000000000000100000050501\r\n10100001000000000000100000007001\r\n10110000000000010000000000050501\r\n10000000000000010000000000000001\r\n11111111111111111111111111111111",z=z.replace(/\r*\n/g,""),E=this.field,f=d=0,y=E.length;y>d;f=++d)switch(C=E[f],this.field[f]=parseInt(z.charAt(f)),S=f%this.size,_=f/this.size|0,this.field[f]){case 6:h[0]={x:S,y:_};break;case 7:h[1]={x:S,y:_}}for(this.team.push(new o(0,h[0],16752640)),this.team.push(new o(1,h[1],65535)),k=this.dismap,f=m=0,g=k.length;g>m;f=++m)C=k[f],this.dismap[f]=[0,6,7,8].some(function(t){return function(n){return t.field[f]===n}}(this))?1:-1;for(this.gField=this.setupField(),this.container.addChild(this.gField),l=new i(this.input),this.player=new u(T,l),this.addUnit(this.player),I=this.team,f=b=0,w=I.length;w>b;f=++b)for(O=I[f],M=T===f?3:4,v=x=0,P=M;P>=0?P>x:x>P;v=P>=0?++x:--x)a=new s,A=new u(f,a),this.addUnit(A);p=this.setupStartView(),this.container.addChild(p),c=this.setupPauseView(),this.scene={},this.scene.init=function(t){return function(){return function(n){return t.input.keys.z?(t.container.removeChild(p),n("main")):void 0}}}(this),this.scene.main=function(t){return function(){var n;return n=!1,t.input.on("space",function(){return n=!n,n?t.container.addChild(c):t.container.removeChild(c)}),function(e){var i,r,s,o,u;if(!n){for(t.updateUnits(),t.input.keys.o&&t.team[0].changePoint(-100),t.input.keys.p&&t.team[1].changePoint(-100),u=void 0,o=t.team,f=s=0,r=o.length;r>s;f=++s)if(O=o[f],0===O.point){u=f===T?!1:!0;break}return void 0!==u?(t.input.offAll(),i=t.setupResultView(u),t.container.addChild(i),e("result")):void 0}}}}(this),this.scene.result=function(t){return function(){return function(t){}}}(this),this.phase=null,this.transit=function(t){return function(n){return t.phase=t.scene[n]().bind(t,t.transit)}}(this),this.transit("init")}return t.prototype.addUnit=function(t){var n,e,i,r,s;return i=t.team,e=this.team[i].base,r=e.x,s=e.y,t.pos.x=r+c.randf(1),t.pos.y=s+c.randf(1),t.ang=i%2?180:0,n=this.setupUnit(t),this.container.addChild(n),this.team[i].units.push({i:t,g:n})},t.prototype.hitCheck=function(t,n){var e,i,r,s;return.5>t||.5>n?-2:t>this.size-.5||n>this.size-.5?-2:(i=Math.floor(t-.5)+this.size*Math.floor(n-.5),r=t-.5-Math.floor(t-.5),s=n-.5-Math.floor(n-.5),1e-4>r&&(r=0),1e-4>s&&(s=0),e=[this.dismap[i],this.dismap[i+1],this.dismap[i+this.size],this.dismap[i+this.size+1]],(1-r)*(1-s)*e[0]+(1-r)*s*e[2]+r*(1-s)*e[1]+r*s*e[3])},t.prototype.fix=function(t){var n,e,i,r,s,o,u;for(s=t.getCollider(),u=[],e=0,i=s.length;i>e;e++)r=s[e],n=this.hitCheck(r.x,r.y),0>n?(o=(t.ang+180)*Math.PI/180,t.pos.x-=n*Math.cos(o),t.pos.y-=n*Math.sin(o),u.push(t.vel=0)):u.push(void 0);return u},t.prototype.setupText=function(t,n,e,i,r,s,o){var u;switch(u=new PIXI.Text(e,{font:i,fill:r,align:s}),s){case"center":u.position.x=t-u.width/2;break;case"right":u.position.x=t-u.width}switch(o){case"center":u.position.y=n-u.height/2;break;case"bottom":u.position.y=n-u.height}return u},t.prototype.setupStartView=function(){var t,n;return t=new PIXI.Graphics,t.lineStyle(0).beginFill(3355443).drawRect(0,0,this.viewsize,this.viewsize).endFill(),t.alpha=.7,n=this.setupText(this.viewsize/2,this.viewsize/2,"PRESS Z","24px Papyrus",16777215,"center","center"),t.addChild(n),t},t.prototype.setupPauseView=function(){var t,n;return t=new PIXI.Graphics,t.lineStyle(0).beginFill(3355443).drawRect(0,0,this.viewsize,this.viewsize).endFill(),t.alpha=.7,n=this.setupText(this.viewsize/2,this.viewsize/2,"Pause","24px Papyrus",16777215,"center","center"),t.addChild(n),t},t.prototype.setupResultView=function(t){var n,e,i,r,s;return e=new PIXI.Graphics,e.lineStyle(0).beginFill(3355443).drawRect(0,0,this.viewsize,this.viewsize).endFill(),e.alpha=.7,n=t?16776960:65535,i=t?"You Win":"You Lose",r=this.setupText(this.viewsize/2,this.viewsize/2,i,"36px Papyrus",n,"center","center"),e.addChild(r),s=this.setupText(this.viewsize/2,3*this.viewsize/4,"PRESS ESC or Reload","16px Papyrus",16777215,"center","bottom"),e.addChild(s),e},t.prototype.setupField=function(){var t,n,e,i,r,s,o,u,a,h,c,p;for(i=new PIXI.Graphics,r=new PIXI.Graphics,e=new PIXI.filters.BlurFilter,e.blur=7,n=function(t){return function(n,e,s){var o,u,a,h,c,p,l,f,d,v,m;for(l=t.dismap,f=[],a=h=0,c=l.length;c>h;a=++h)if(d=l[a],v=a%t.size,m=a/t.size|0,!(v>t.size-2)){if(m>t.size-2)break;o=[t.dismap[a],t.dismap[a+1],t.dismap[a+t.size],t.dismap[a+t.size+1]],u=[t.field[a],t.field[a+1],t.field[a+t.size],t.field[a+t.size+1]],u.some(function(t){return t===n})&&(p=[],o[0]*o[1]<0&&p.push({x:v+.5,y:m}),o[0]*o[2]<0&&p.push({x:v,y:m+.5}),o[1]*o[3]<0&&p.push({x:v+1,y:m+.5}),o[2]*o[3]<0&&p.push({x:v+.5,y:m+1}),2===p.length&&(i.lineStyle(e,s).moveTo((p[0].x+.5)*t.gridSize,(p[0].y+.5)*t.gridSize).lineTo((p[1].x+.5)*t.gridSize,(p[1].y+.5)*t.gridSize),f.push(r.lineStyle(2*e,s).moveTo((p[0].x+.5)*t.gridSize,(p[0].y+.5)*t.gridSize).lineTo((p[1].x+.5)*t.gridSize,(p[1].y+.5)*t.gridSize))))}return f}}(this),n(1,2,65407),n(2,2,16744192),n(3,2,16723968),n(4,2,41215),n(5,2,20735),u=this.team,s=0,o=u.length;o>s;s++)h=u[s],a=""+h.point,t=16777215,c=(h.base.x+.5)*this.gridSize,p=(h.base.y+.5)*this.gridSize,h.scoreborad=this.setupText(c,p,a,"36px Papyrus",t,"center","center"),h.scoreborad.alpha=.7,h.scoreboradUpdate=function(t){return function(){var n;return n=t.gridSize,function(){return c=(this.base.x+.5)*n,p=(this.base.y+.5)*n,this.scoreborad.position.x=c-this.scoreborad.width/2,this.scoreborad.position.y=p-this.scoreborad.height/2}}}(this)(),i.addChild(h.scoreborad);return i.blendMode=PIXI.BLEND_MODES.ADD,i.alpha=.7,r.alpha=.3,r.filters=[e],i.addChild(r),i},t.prototype.setupUnit=function(t){var n,e,i,r,s,o,u,a,h,c,p;return n=new PIXI.Graphics,e=t.pos.x*this.gridSize,i=t.pos.y*this.gridSize,p=t.size*this.gridSize,r=p,s=0,c=-150*Math.PI/180,o=p*Math.cos(c),u=p*Math.sin(c),c=150*Math.PI/180,a=p*Math.cos(c),h=p*Math.sin(c),n.lineStyle(2,this.team[t.team].color).moveTo(r,s).lineTo(o,u).lineTo(0,0).lineTo(a,h).lineTo(r,s),n.position.x=e,n.position.y=i,n},t.prototype.updateUnits=function(){var t,n,e,i,r,s;for(e=this.team,i=[],t=0,n=e.length;n>t;t++)r=e[t],i.push(function(){var t,n,e,i;for(e=r.units,i=[],t=0,n=e.length;n>t;t++)s=e[t],s.i.update(),this.fix(s.i),s.g.position.x=s.i.pos.x*this.gridSize,s.g.position.y=s.i.pos.y*this.gridSize,i.push(s.g.rotation=s.i.ang*Math.PI/180);return i}.call(this));return i},t.prototype.update=function(){return this.input.keys.esc&&location.reload(),this.phase()},t}(),n.exports=a},{"./brain/human":6,"./brain/standard":7,"./input":8,"./team":10,"./unit":11,"./util":12,path:1}],4:[function(t,n,e){n.exports={IDOL:0,MOVE:{TOP:1,BOTTOM:2,LEFT:3,RIGHT:4},ATTACK:{AIM:5,FOWARD:6}}},{}],5:[function(t,n,e){var i;i=function(){function t(){}return t.prototype.update=function(t){},t}(),n.exports=i},{}],6:[function(t,n,e){var i,r,s,o=function(t,n){function e(){this.constructor=t}for(var i in n)u.call(n,i)&&(t[i]=n[i]);return e.prototype=n.prototype,t.prototype=new e,t.__super__=n.prototype,t},u={}.hasOwnProperty;r=t("../brain"),i=t("../actions"),s=function(t){function n(t){this.input=t,n.__super__.constructor.call(this)}return o(n,t),n.prototype.update=function(t){var e;return n.__super__.update.call(this,t),e=[],this.input.keys.up&&e.push(i.MOVE.TOP),this.input.keys.down&&e.push(i.MOVE.BOTTOM),this.input.keys.right&&e.push(i.MOVE.RIGHT),this.input.keys.left&&e.push(i.MOVE.LEFT),this.input.keys.z&&e.push(i.ATTACK.AIM),e},n}(r),n.exports=s},{"../actions":4,"../brain":5}],7:[function(t,n,e){var i,r,s,o,u=function(t,n){function e(){this.constructor=t}for(var i in n)a.call(n,i)&&(t[i]=n[i]);return e.prototype=n.prototype,t.prototype=new e,t.__super__=n.prototype,t},a={}.hasOwnProperty;o=t("../util"),r=t("../brain"),i=t("../actions"),s=function(t){function n(){n.__super__.constructor.call(this)}return u(n,t),n.prototype.update=function(t){var e;return n.__super__.update.call(this,t),e=[],e.push(o.randArray([i.MOVE.TOP,i.MOVE.BOTTOM,i.MOVE.LEFT,i.MOVE.RIGHT])),e},n}(r),n.exports=s},{"../actions":4,"../brain":5,"../util":12}],8:[function(t,n,e){var i,r=[].indexOf||function(t){for(var n=0,e=this.length;e>n;n++)if(n in this&&this[n]===t)return n;return-1},s={}.hasOwnProperty;i=function(){function t(t){var n,e,i,o,u,a,h,c,p;this.domElement=null!=t?t:document,this.keys={},this.listener={},this.keyMap={8:"backspace",13:"enter",16:"shift",17:"ctrl",18:"alt",27:"esc",32:"space",37:"left",38:"up",39:"right",40:"down"},o=function(t){return function(n,e){return{key:t.keyMap[n]||String.fromCharCode(n).toLowerCase(),status:e}}}(this),e=Bacon.fromEventTarget(this.domElement,"keydown").map(function(t){return function(n){return o.call(t,n.keyCode,!0)}}(this)),i=Bacon.fromEventTarget(this.domElement,"keyup").map(function(t){return function(n){return o.call(t,n.keyCode,!1)}}(this)),e.merge(i).filter(function(t){var n;return n=t.key.charCodeAt(0),n>47&&58>n||n>96&&123>n}).onValue(function(t){return function(n){var e;return t.keys[n.key]=n.status,n.status&&null!=(e=t.listener[n.key])?e.forEach(function(t){return t()}):void 0}}(this)),n=[1,2],u=function(t){return function(e){var i;return i={},n.forEach(function(t){return i[t]=[]}),Bacon.fromEventTarget(t.domElement,e).filter(function(t){var e;return e=t.button,r.call(n,e)>=0}).onValue(function(t){return i[t.button].forEach(function(n){return n(t.clientX,t.clientY)})}),[function(t,n){var e;return null!=(e=i[t])?e.push(n):void 0},function(t,n){return _.remove(i[t],function(t){return null!=n?t===n:!0})}]}}(this),a=u("mousedown"),this.onMouseDown=a[0],this.offMouseDown=a[1],h=u("mouseup"),this.onMouseUp=h[0],this.offMouseUp=h[1],c=_.transform(u("dblclick"),function(t,n){return t.push(n.bind(this,1))}),this.onDoubleClick=c[0],this.offDoubleClick=c[1],p=function(t){return function(){var e,i,r,o;return i={},e={},n.forEach(function(t){return e[t]=!1,i[t]=[]}),r=Bacon.fromEventTarget(t.domElement,"mousedown").map(function(t){return[t.button,!0]}),o=Bacon.fromEventTarget(t.domElement,"mouseup").map(function(t){return[t.button,!1]}),r.merge(o).onValue(function(t){return null!=e[t[0]]?e[t[0]]=t[1]:void 0}),Bacon.fromEventTarget(t.domElement,"mousemove").onValue(function(t){var n,r,o;r=[];for(n in i)s.call(i,n)&&(o=i[n],r.push(o.forEach(function(i){return e[n]?i(t.clientX,t.clientY):void 0})));return r}),[function(t,n){var e;return null!=(e=i[t])?e.push(n):void 0},function(t,n){return _.remove(i[t],function(t){return null!=n?t===n:!0})}]}}(this)(),this.onMouseMove=p[0],this.offMouseMove=p[1],this.offAll=function(t){return function(){return n.forEach(function(n){return t.offMouseDown(n),t.offMouseUp(n),t.offMouseMove(n)}),t.offDoubleClick(),t.listener={}}}(this)}return t.prototype.on=function(t,n){return this.listener[t]?this.listener[t].push(n):this.listener[t]=[n]},t.prototype.off=function(t,n){return _.remove(this.listener[t],function(t){return t===n})},t}(),n.exports=i},{}],9:[function(t,n,e){"use strict";var i,r,s;r=t("./view"),s=t("./World"),i=function(){function t(){this.view=new r,this.world=new s(this.view.container,this.view.size)}return t.prototype.loop=function(){return requestAnimationFrame(function(t){return function(){return t.loop()}}(this)),this.view.render(function(t){return function(){return t.world.update()}}(this))},t}(),$(function(){return(new i).loop()})},{"./World":3,"./view":13}],10:[function(t,n,e){var i;i=function(){function t(t,n,e,i){this.id=t,this.base=n,this.color=e,this.point=null!=i?i:100,this.units=[]}return t.prototype.changePoint=function(t){return this.point+=t,this.point=Math.max(0,this.point),this.scoreborad.text=""+this.point,this.scoreboradUpdate()},t.prototype.eachMembers=function(t){var n,e,i,r,s;for(i=this.units,r=[],n=0,e=i.length;e>n;n++)s=i[n],r.push(t(s));return r},t}(),n.exports=i},{}],11:[function(t,n,e){var i,r;i=t("./actions"),r=function(){function t(t,n){this.team=t,this.brain=n,this.pos={x:0,y:0},this.ang=0,this.shotang=0,this.size=.2,this.vel=0}return t.prototype.getCollider=function(){var t,n;return t=[],n=this.ang*Math.PI/180,t.push({x:this.pos.x+this.size*Math.cos(n),y:this.pos.y+this.size*Math.sin(n)}),t},t.prototype.action=function(t){var n,e,r,s,o,u,a;for(u=0,e=!1,a=!1,r=[void 0,-90,90,void 0,180,-135,135,180,0,-45,45,0,void 0,-90,90,void 0],s=0,o=t.length;o>s;s++)switch(n=t[s]){case i.MOVE.TOP:u+=1;break;case i.MOVE.BOTTOM:u+=2;break;case i.MOVE.LEFT:u+=4;break;case i.MOVE.RIGHT:u+=8;break;case i.ATTACK.AIM:e=!0,a=!0;break;case i.ATTACK.FOWARD:a=!0}return null!=r[u]?(this.ang=r[u],this.vel=e?.04:.07):this.vel=0,a?0:void 0},t.prototype.update=function(){var t;return this.action(this.brain.update(this)),t=this.ang*Math.PI/180,this.pos.x+=this.vel*Math.cos(t),this.pos.y+=this.vel*Math.sin(t),this.vel=.7*this.vel,this.vel*this.vel<1e-4?this.vel=0:void 0},t}(),n.exports=r},{"./actions":4}],12:[function(t,n,e){var i;i=function(){function t(){}return t.rand=function(t){return Math.floor(Math.random()*t)},t.randf=function(t){return Math.random()*t},t.randRange=function(t,n){return Math.floor(Math.random()*(n-t+1))+t},t.randArray=function(t){return t[Math.floor(Math.random()*t.length)]},t}(),n.exports=i},{}],13:[function(t,n,e){var i;i=function(){function t(){this.size=640,this.renderer=PIXI.autoDetectRenderer(this.size,this.size,{backgroundColor:0,antialias:!0}),$(document.body).append(this.renderer.view),this.container=new PIXI.Container,this.stats=new Stats,this.stats.setMode(0),this.stats.domElement.style.position="absolute",this.stats.domElement.style.right="0px",this.stats.domElement.style.top="0px",$(document.body).append(this.stats.domElement)}return t.prototype.render=function(t){return this.stats.begin(),t(),this.renderer.render(this.container),this.stats.end()},t}(),n.exports=i},{}]},{},[9]);
//# sourceMappingURL=bundle.js.map