!function t(e,i,n){function r(o,h){if(!i[o]){if(!e[o]){var u="function"==typeof require&&require;if(!h&&u)return u(o,!0);if(s)return s(o,!0);var a=new Error("Cannot find module '"+o+"'");throw a.code="MODULE_NOT_FOUND",a}var c=i[o]={exports:{}};e[o][0].call(c.exports,function(t){var i=e[o][1][t];return r(i?i:t)},c,c.exports,t,e,i,n)}return i[o].exports}for(var s="function"==typeof require&&require,o=0;o<n.length;o++)r(n[o]);return r}({1:[function(t,e,i){(function(t){function e(t,e){for(var i=0,n=t.length-1;n>=0;n--){var r=t[n];"."===r?t.splice(n,1):".."===r?(t.splice(n,1),i++):i&&(t.splice(n,1),i--)}if(e)for(;i--;i)t.unshift("..");return t}function n(t,e){if(t.filter)return t.filter(e);for(var i=[],n=0;n<t.length;n++)e(t[n],n,t)&&i.push(t[n]);return i}var r=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,s=function(t){return r.exec(t).slice(1)};i.resolve=function(){for(var i="",r=!1,s=arguments.length-1;s>=-1&&!r;s--){var o=s>=0?arguments[s]:t.cwd();if("string"!=typeof o)throw new TypeError("Arguments to path.resolve must be strings");o&&(i=o+"/"+i,r="/"===o.charAt(0))}return i=e(n(i.split("/"),function(t){return!!t}),!r).join("/"),(r?"/":"")+i||"."},i.normalize=function(t){var r=i.isAbsolute(t),s="/"===o(t,-1);return t=e(n(t.split("/"),function(t){return!!t}),!r).join("/"),t||r||(t="."),t&&s&&(t+="/"),(r?"/":"")+t},i.isAbsolute=function(t){return"/"===t.charAt(0)},i.join=function(){var t=Array.prototype.slice.call(arguments,0);return i.normalize(n(t,function(t,e){if("string"!=typeof t)throw new TypeError("Arguments to path.join must be strings");return t}).join("/"))},i.relative=function(t,e){function n(t){for(var e=0;e<t.length&&""===t[e];e++);for(var i=t.length-1;i>=0&&""===t[i];i--);return e>i?[]:t.slice(e,i-e+1)}t=i.resolve(t).substr(1),e=i.resolve(e).substr(1);for(var r=n(t.split("/")),s=n(e.split("/")),o=Math.min(r.length,s.length),h=o,u=0;o>u;u++)if(r[u]!==s[u]){h=u;break}for(var a=[],u=h;u<r.length;u++)a.push("..");return a=a.concat(s.slice(h)),a.join("/")},i.sep="/",i.delimiter=":",i.dirname=function(t){var e=s(t),i=e[0],n=e[1];return i||n?(n&&(n=n.substr(0,n.length-1)),i+n):"."},i.basename=function(t,e){var i=s(t)[2];return e&&i.substr(-1*e.length)===e&&(i=i.substr(0,i.length-e.length)),i},i.extname=function(t){return s(t)[3]};var o="b"==="ab".substr(-1)?function(t,e,i){return t.substr(e,i)}:function(t,e,i){return 0>e&&(e=t.length+e),t.substr(e,i)}}).call(this,t("_process"))},{_process:2}],2:[function(t,e,i){function n(){c=!1,h.length?a=h.concat(a):p=-1,a.length&&r()}function r(){if(!c){var t=setTimeout(n);c=!0;for(var e=a.length;e;){for(h=a,a=[];++p<e;)h&&h[p].run();p=-1,e=a.length}h=null,c=!1,clearTimeout(t)}}function s(t,e){this.fun=t,this.array=e}function o(){}var h,u=e.exports={},a=[],c=!1,p=-1;u.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)e[i-1]=arguments[i];a.push(new s(t,e)),1!==a.length||c||setTimeout(r,0)},s.prototype.run=function(){this.fun.apply(null,this.array)},u.title="browser",u.browser=!0,u.env={},u.argv=[],u.version="",u.versions={},u.on=o,u.addListener=o,u.once=o,u.off=o,u.removeListener=o,u.removeAllListeners=o,u.emit=o,u.binding=function(t){throw new Error("process.binding is not supported")},u.cwd=function(){return"/"},u.chdir=function(t){throw new Error("process.chdir is not supported")},u.umask=function(){return 0}},{}],3:[function(t,e,i){var n,r,s,o,h,u,a,c,p;c=t("path"),p=t("./util"),s=t("./input"),u=t("./unit"),h=t("./team"),n=t("./bullet"),r=t("./brain/human"),o=t("./brain/standard"),a=function(){function t(t,e,i){var n,a,c,p,l,f,d,v,m,g,y,b,w,x,z,M,T,E,I,C,k,P,A,S,O,_,V;for(this.container=t,this.viewsize=e,this.size=null!=i?i:32,this.input=new s,this.size2=this.size*this.size,this.gridSize=this.viewsize/this.size,this.resolution=2,this.resolution2=this.resolution*this.resolution,this.sizer=this.size*this.resolution,this.sizer2=this.sizer*this.sizer,this.gridSizer=this.viewsize/this.sizer,this.field=new Uint8Array(this.size2),this.dismap=new Int32Array(this.size2),E=1,this.team=[],a=[{},{}],c=[{},{}],z="11111111111111111111111111111111\r\n10000000000000001000000000000001\r\n10303000000000001000000000001101\r\n10060000000100000000000010000101\r\n10303000000100000000000010000001\r\n10000000000000001000000110000001\r\n10000000000000001000111111000001\r\n10000003303300000000001111110001\r\n10000003000300001000000110000001\r\n10000000020000001000000100000001\r\n10000003000300001000000100000001\r\n10000003303300001011000000111111\r\n10000000000000001011100000000001\r\n10000000000000011011100000000001\r\n10000000000000011000000000000001\r\n10111110111111111110000000000001\r\n10000000000001111111111101111101\r\n10000000000000011000000000000001\r\n10000000000111011000000000000001\r\n10000000000111010000000000000001\r\n11111100000011010000550550000001\r\n10000000100000010000500050000001\r\n10000000100000010000004000000001\r\n10000001100000010000500050000001\r\n10001111110000000000550550000001\r\n10000011111100010000000000000001\r\n10000001100000010000000000000001\r\n10000001000000000000100000050501\r\n10100001000000000000100000007001\r\n10110000000000010000000000050501\r\n10000000000000010000000000000001\r\n11111111111111111111111111111111",z=z.replace(/\r*\n/g,""),I=this.field,d=v=0,y=I.length;y>v;d=++v)switch(O=I[d],this.field[d]=parseInt(z.charAt(d)),_=d%this.size,V=d/this.size|0,this.field[d]){case 6:a[0]={x:_,y:V};break;case 7:a[1]={x:_,y:V};break;case 2:c[0]={x:_,y:V};break;case 4:c[1]={x:_,y:V}}for(this.team.push(new h(0,a[0],c[0],16752640)),this.team.push(new h(1,a[1],c[1],65535)),C=this.team,d=g=0,b=C.length;b>g;d=++g)for(A=C[d],A.mapsize=this.size,A.mapresolution=this.resolution,A.coredismap=new Int32Array(this.sizer2),this.setCoredismap(A,this.team[1-d].core),M=E===d?3:4,m=x=0,k=M;k>=0?k>x:x>k;m=k>=0?++x:--x)n=new o(A),S=new u(d,A.base,n),this.addUnit(S);for(P=this.dismap,d=T=0,w=P.length;w>T;d=++T)O=P[d],this.dismap[d]=[0,6,7,8].some(function(t){return function(e){return t.field[d]===e}}(this))?1:-1;this.gField=this.setupField(),this.container.addChild(this.gField),f=new r(this.input),this.player=new u(E,this.team[E].base,f),this.addUnit(this.player),l=this.setupStartView(),this.container.addChild(l),p=this.setupPauseView(),this.scene={},this.scene.init=function(t){return function(){return function(e){return t.input.keys.z?(t.container.removeChild(l),e("main")):void 0}}}(this),this.scene.main=function(t){return function(){var e;return e=!1,t.input.on("space",function(){return e=!e,e?t.container.addChild(p):t.container.removeChild(p)}),function(i){var n,r,s,o,h;if(!e){for(t.updateUnits(),t.updateBullets(),t.input.keys.o&&t.team[0].changePoint(-100),t.input.keys.p&&t.team[1].changePoint(-100),h=void 0,o=t.team,d=s=0,r=o.length;r>s;d=++s)if(A=o[d],0===A.point){h=d===E?!1:!0;break}return void 0!==h?(t.input.offAll(),n=t.setupResultView(h),t.container.addChild(n),i("result")):void 0}}}}(this),this.scene.result=function(t){return function(){return function(t){}}}(this),this.phase=null,this.transit=function(t){return function(e){return t.phase=t.scene[e]().bind(t,t.transit)}}(this),this.transit("init")}return t.prototype.setCoredismap=function(t,e){var i,n,r,s,o,h,u,a,c,p,l,f,d,v,m,g,y,b,w,x,z,M,T,E,I,C,k,P,A,S,O,_,V,D,F,B,R;for(i=t.coredismap,T=[],I=[0,1],a=0,l=I.length;l>a;a++)for(c=I[a],C=[0,1],p=0,f=C.length;f>p;p++)o=C[p],T.push({x:e.x*this.resolution+o,y:e.y*this.resolution+c,v:1});for(r=[],k=[-1,0,1],w=0,d=k.length;d>w;w++)for(c=k[w],P=[-1,0,1],x=0,v=P.length;v>x;x++)o=P[x],(0!==o||0!==c)&&r.push([o,c]);for(u=function(t){return function(e,i){var n,r,s,h,u,a,p,l,f;for(l=e*t.resolution,f=i*t.resolution,p=[],u=[0,1],s=0,n=u.length;n>s;s++)for(c=u[s],a=[0,1],h=0,r=a.length;r>h;h++)o=a[h],p.push(l+o+(f+c)*t.sizer);return p}}(this),A=this.field,o=z=0,m=A.length;m>z;o=++z)if(s=A[o],![0,6,7,8].some(function(t){return function(t){return s===t}}(this)))for(B=o%this.size,R=o/this.size|0,S=u(B,R),M=0,g=S.length;g>M;M++)h=S[M],i[h]=-1;for(;T.length>0;)for(O=T[0],B=O.x,R=O.y,F=O.v,T.splice(0,1),E=0,y=r.length;y>E;E++)n=r[E],h=B+n[0]+(R+n[1])*this.sizer,0===i[h]&&(i[h]=F,T.push({x:B+n[0],y:R+n[1],v:F+1}));for(_=u(e.x,e.y),V=[],D=0,b=_.length;b>D;D++)h=_[D],V.push(i[h]=0);return V},t.prototype.addUnit=function(t){var e,i,n,r,s;return n=t.team,i=this.team[n].base,r=i.x,s=i.y,t.pos.x=r+p.randf(1),t.pos.y=s+p.randf(1),t.ang=n%2?180:0,e=this.setupUnit(t),this.container.addChild(e),this.team[n].units.push({i:t,g:e})},t.prototype.addBullet=function(t){var e,i,r;return r=t.team,e=new n({x:t.pos.x,y:t.pos.y},.1,t.shotang,.1,t),i=this.setupBullet(e),this.container.addChild(i),this.team[r].bullets.push({i:e,g:i})},t.prototype.hitCheck=function(t,e){var i,n,r,s,o,h;return.5>t||.5>e?-2:t>this.size-.5||e>this.size-.5?-2:(r=Math.floor(t-.5)+this.size*Math.floor(e-.5),o=t-.5-Math.floor(t-.5),h=e-.5-Math.floor(e-.5),1e-4>o&&(o=0),1e-4>h&&(h=0),i=[this.dismap[r],this.dismap[r+1],this.dismap[r+this.size],this.dismap[r+this.size+1]],n=[this.field[r],this.field[r+1],this.field[r+this.size],this.field[r+this.size+1]],s=(1-o)*(1-h)*i[0]+(1-o)*h*i[2]+o*(1-h)*i[1]+o*h*i[3],_.remove(n,function(t){return 0===t}),{d:s,f:_.uniq(n)})},t.prototype.fix=function(t){var e,i,n,r,s,o,h,u,a;for(o=t.getCollider(),a=[],n=0,r=o.length;r>n;n++)s=o[n],u=this.hitCheck(s.x,s.y),e=u.d,i=u.f,0>e?(h=(t.ang+180)*Math.PI/180,t.pos.x-=e*Math.cos(h),t.pos.y-=e*Math.sin(h),a.push(t.vel=0)):a.push(void 0);return a},t.prototype.setupText=function(t,e,i,n,r,s,o){var h;switch(h=new PIXI.Text(i,{font:n,fill:r,align:s}),s){case"left":h.position.x=t;break;case"center":h.position.x=t-h.width/2;break;case"right":h.position.x=t-h.width}switch(o){case"top":h.position.y=e;break;case"center":h.position.y=e-h.height/2;break;case"bottom":h.position.y=e-h.height}return h},t.prototype.setupStartView=function(){var t,e,i,n,r,s;return i=new PIXI.Graphics,i.lineStyle(0).beginFill(3355443).drawRect(0,0,this.viewsize,this.viewsize).endFill(),i.alpha=.7,n=this.setupText(this.viewsize/2,this.viewsize/2,"PRESS Z","24px Papyrus",16777215,"center","center"),i.addChild(n),t=(p.rand(256)<<16)+(p.rand(256)<<8)+p.rand(256),r=this.setupText(this.viewsize/2,this.viewsize/4,"harmony","56px Papyrus",t,"center","center"),e=new PIXI.filters.BlurFilter,e.blur=32,r.filters=[e],i.addChild(r),s=this.setupText(this.viewsize/2,this.viewsize/4,"harmony","56px Papyrus",16777215,"center","center"),i.addChild(s),i},t.prototype.setupPauseView=function(){var t,e;return t=new PIXI.Graphics,t.lineStyle(0).beginFill(3355443).drawRect(0,0,this.viewsize,this.viewsize).endFill(),t.alpha=.7,e=this.setupText(this.viewsize/2,this.viewsize/2,"Pause","24px Papyrus",16777215,"center","center"),t.addChild(e),t},t.prototype.setupResultView=function(t){var e,i,n,r,s,o,h;return i=new PIXI.filters.BlurFilter,i.blur=24,n=new PIXI.Graphics,n.lineStyle(0).beginFill(3355443).drawRect(0,0,this.viewsize,this.viewsize).endFill(),n.alpha=.7,e=t?16776960:65535,r=t?"You Win":"You Lose",s=this.setupText(this.viewsize/2,this.viewsize/2,r,"36px Papyrus",e,"center","center"),n.addChild(s),h=this.setupText(this.viewsize/2,this.viewsize/2,r,"36px Papyrus",e,"center","center"),h.filters=[i],n.addChild(h),o=this.setupText(this.viewsize/2,3*this.viewsize/4,"PRESS ESC or Reload","16px Papyrus",16777215,"center","bottom"),n.addChild(o),n},t.prototype.setupField=function(){var t,e,i,n,r,s,o,h,u,a,c,p,l,f,d,v,m,g,y,b,w,x,z,M,T;for(s=new PIXI.Graphics,o=new PIXI.Graphics,n=new PIXI.filters.BlurFilter,n.blur=7,i=function(t){return function(e,i,n){var r,h,u,a,c,p,l,f,d,v,m;for(l=t.dismap,f=[],u=a=0,c=l.length;c>a;u=++a)if(d=l[u],v=u%t.size,m=u/t.size|0,!(v>t.size-2)){if(m>t.size-2)break;r=[t.dismap[u],t.dismap[u+1],t.dismap[u+t.size],t.dismap[u+t.size+1]],h=[t.field[u],t.field[u+1],t.field[u+t.size],t.field[u+t.size+1]],h.some(function(t){return t===e})&&(p=[],r[0]*r[1]<0&&p.push({x:v+.5,y:m}),r[0]*r[2]<0&&p.push({x:v,y:m+.5}),r[1]*r[3]<0&&p.push({x:v+1,y:m+.5}),r[2]*r[3]<0&&p.push({x:v+.5,y:m+1}),2===p.length&&(s.lineStyle(i,n).moveTo((p[0].x+.5)*t.gridSize,(p[0].y+.5)*t.gridSize).lineTo((p[1].x+.5)*t.gridSize,(p[1].y+.5)*t.gridSize),f.push(o.lineStyle(2*i,n).moveTo((p[0].x+.5)*t.gridSize,(p[0].y+.5)*t.gridSize).lineTo((p[1].x+.5)*t.gridSize,(p[1].y+.5)*t.gridSize))))}return f}}(this),i(1,2,65407),i(2,2,16744192),i(3,2,16723968),i(4,2,41215),i(5,2,20735),r=new PIXI.filters.BlurFilter,r.blur=32,d=this.team,u=0,c=d.length;c>u;u++)y=d[u],g=""+y.point,t=16777215,M=(y.base.x+.5)*this.gridSize,T=(y.base.y+.5)*this.gridSize,y.scoreborad=this.setupText(M,T,g,"36px Papyrus",t,"center","center"),y.scoreborad2=this.setupText(M,T,g,"36px Papyrus",y.color,"center","center"),y.scoreborad2.filters=[r],y.scoreborad.alpha=.7,y.scoreboradUpdate=function(t){return function(){var e;return e=t.gridSize,function(){return M=(this.base.x+.5)*e,T=(this.base.y+.5)*e,this.scoreborad.text=""+this.point,this.scoreborad2.text=this.scoreborad.text,this.scoreborad.position.x=M-this.scoreborad.width/2,this.scoreborad.position.y=T-this.scoreborad.height/2,this.scoreborad2.position=this.scoreborad.position}}}(this)(),s.addChild(y.scoreborad2),s.addChild(y.scoreborad);for(s.blendMode=PIXI.BLEND_MODES.ADD,s.alpha=.7,o.filters=[n],s.addChild(o),v=this.team,w=a=0,p=v.length;p>a;w=++a)if(y=v[w],0===w)for(m=y.coredismap,h=f=0,l=m.length;l>f;h=++f)e=m[h],e>0&&(M=h%this.sizer,T=h/this.sizer|0,x=(M+.5)*this.gridSizer,z=(T+.5)*this.gridSizer,b=this.setupText(x,z,""+e,"8px",16777215,"center","center"));return s},t.prototype.setupBullet=function(t){var e,i,n,r;return e=new PIXI.Graphics,i=t.pos.x*this.gridSize,n=t.pos.y*this.gridSize,r=t.size*this.gridSize,e.lineStyle(1,this.team[t.team].color).drawCircle(0,0,r),e.position.x=i,e.position.y=n,e},t.prototype.setupUnit=function(t){var e,i,n,r,s,o,h,u,a,c,p;return e=new PIXI.Graphics,i=t.pos.x*this.gridSize,n=t.pos.y*this.gridSize,p=t.size*this.gridSize,r=p,s=0,c=-150*Math.PI/180,o=p*Math.cos(c),h=p*Math.sin(c),c=150*Math.PI/180,u=p*Math.cos(c),a=p*Math.sin(c),e.lineStyle(2,this.team[t.team].color).moveTo(r,s).lineTo(o,h).lineTo(0,0).lineTo(u,a).lineTo(r,s),t.scoreborad=this.setupText(i+1.4*p,n-1.4*p,""+t.hp,"14px Papyrus",16777215,"center","center"),t.scoreboradUpdate=function(t){return function(){var e;return e=t.gridSize,function(){return i=this.pos.x*e,n=this.pos.y*e,p=this.size*e,this.scoreborad.text=""+this.hp,this.scoreborad.position.x=i+1.4*p,this.scoreborad.position.y=n-1.4*p}}}(this)(),this.container.addChild(t.scoreborad),e.position.x=i,e.position.y=n,e.rotation=t.ang*Math.PI/180,e},t.prototype.updateUnits=function(){var t,e,i,n,r,s,o,h,u,a,c;for(h=this.team,u=[],e=0,i=h.length;i>e;e++)a=h[e],u.push(function(){var e,i,h,u,p,l,f,d,v,m;for(f=a.units,m=[],e=0,i=f.length;i>e;e++){for(c=f[e],c.i.update(function(t){return function(e){return t.addBullet(e)}}(this)),this.fix(c.i),d=this.team,p=0,h=d.length;h>p;p++)if(a=d[p],c.i.team!==a.id)for(n=c.i.pos,s=c.i.size/2,v=a.bullets,l=0,u=v.length;u>l;l++)t=v[l],r=t.i.pos,o=t.i.size,Math.pow(n.x-r.x,2)+Math.pow(n.y-r.y,2)<Math.pow(s+o,2)&&(t.i.removeflag=!0,c.i.hp--,c.i.scoreboradUpdate());c.g.position.x=c.i.pos.x*this.gridSize,c.g.position.y=c.i.pos.y*this.gridSize,m.push(c.g.rotation=c.i.ang*Math.PI/180)}return m}.call(this));return u},t.prototype.updateBullets=function(){var t,e,i,n,r,s,o,h,u,a,c,p,l,f,d,v,m,g,y,b,w;for(d=this.team,y=[],r=0,o=d.length;o>r;r++){for(b=d[r],g=[],v=b.bullets,n=s=0,h=v.length;h>s;n=++s){for(t=v[n],t.i.update(),f=t.i.getCollider(),c=0,u=f.length;u>c;c++)if(l=f[c],m=this.hitCheck(l.x,l.y),e=m.d,i=m.f,0>e)for(t.i.removeflag=!0,p=0,a=i.length;a>p;p++)switch(w=i[p]){case 2:if(0===t.i.team)break;this.team[0].changePoint(-1);break;case 4:if(1===t.i.team)break;this.team[1].changePoint(-1)}t.g.position.x=t.i.pos.x*this.gridSize,t.g.position.y=t.i.pos.y*this.gridSize,t.g.rotation=t.i.rad,t.i.removeflag&&(g.push(n),this.container.removeChild(t.g))}y.push(_.remove(b.bullets,function(t,e){return g.some(function(t){return t===e})}))}return y},t.prototype.update=function(){return this.input.keys.esc&&location.reload(),this.phase()},t}(),e.exports=a},{"./brain/human":6,"./brain/standard":7,"./bullet":8,"./input":9,"./team":12,"./unit":13,"./util":14,path:1}],4:[function(t,e,i){e.exports={IDOL:0,MOVE:{TOP:1,BOTTOM:2,LEFT:3,RIGHT:4},ATTACK:{AIM:5,FOWARD:6}}},{}],5:[function(t,e,i){var n;n=function(){function t(){}return t.prototype.update=function(t){},t}(),e.exports=n},{}],6:[function(t,e,i){var n,r,s,o=function(t,e){function i(){this.constructor=t}for(var n in e)h.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},h={}.hasOwnProperty;r=t("../brain"),n=t("../actions"),s=function(t){function e(t){this.input=t,e.__super__.constructor.call(this)}return o(e,t),e.prototype.update=function(t){var i;return e.__super__.update.call(this,t),i=[],this.input.keys.up&&i.push(n.MOVE.TOP),this.input.keys.down&&i.push(n.MOVE.BOTTOM),this.input.keys.right&&i.push(n.MOVE.RIGHT),this.input.keys.left&&i.push(n.MOVE.LEFT),this.input.keys.z&&i.push(n.ATTACK.AIM),i},e}(r),e.exports=s},{"../actions":4,"../brain":5}],7:[function(t,e,i){var n,r,s,o,h=function(t,e){function i(){this.constructor=t}for(var n in e)u.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},u={}.hasOwnProperty;o=t("../util"),r=t("../brain"),n=t("../actions"),s=function(t){function e(t){this.team=t,e.__super__.constructor.call(this),this.prevacts=[]}return h(e,t),e.prototype.update=function(t){var i,r,s,h,u,a,c,p,l,f,d,v,m,g,y,b,w,x,z,M,T,E,I;if(e.__super__.update.call(this,t),o.rand(10))return this.prevacts;for(i=[],u=[],z=[-1,0,1],l=0,v=z.length;v>l;l++)for(f=z[l],M=[-1,0,1],d=0,m=M.length;m>d;d++)c=M[d],(0!==c||0!==f)&&u.push([c,f]);if(T=t.pos,E=T.x,I=T.y,w=Math.ceil(E*this.team.mapresolution),x=Math.ceil(I*this.team.mapresolution),s=this.team.coredismap[w+x*this.team.mapsize*this.team.mapresolution],o.rand(5)){for(b=s,r=[],y=0,g=u.length;g>y;y++)h=u[y],p=w+h[0]+(x+h[1])*this.team.mapsize*this.team.mapresolution,a=this.team.coredismap[p],0>a||(a===b?r.push(h):b>a&&(r=[h],b=a));if(r.length>0){switch(h=o.randArray(r),h[0]){case-1:i.push(n.MOVE.LEFT);break;case 1:i.push(n.MOVE.RIGHT)}switch(h[1]){case-1:i.push(n.MOVE.TOP);break;case 1:i.push(n.MOVE.BOTTOM)}}}else i.push(o.randArray([n.MOVE.TOP,n.MOVE.BOTTOM,n.MOVE.LEFT,n.MOVE.RIGHT]));return i.push(n.ATTACK.AIM),this.prevacts=i},e}(r),e.exports=s},{"../actions":4,"../brain":5,"../util":14}],8:[function(t,e,i){var n;n=function(){function t(t,e,i,n,r){this.pos=t,this.size=e,this.vel=n,this.parent=r,this.rad=i*Math.PI/180,this.team=this.parent.team,this.r=0}return t.prototype.getCollider=function(){var t;return t=[],t.push({x:this.pos.x,y:this.pos.y}),t},t.prototype.update=function(){return this.pos.x+=this.vel*Math.cos(this.rad),this.pos.y+=this.vel*Math.sin(this.rad),this.r+=this.vel},t}(),e.exports=n},{}],9:[function(t,e,i){var n,r=[].indexOf||function(t){for(var e=0,i=this.length;i>e;e++)if(e in this&&this[e]===t)return e;return-1},s={}.hasOwnProperty;n=function(){function t(t){var e,i,n,o,h,u,a,c,p;this.domElement=null!=t?t:document,this.keys={},this.listener={},this.keyMap={8:"backspace",13:"enter",16:"shift",17:"ctrl",18:"alt",27:"esc",32:"space",37:"left",38:"up",39:"right",40:"down"},o=function(t){return function(e,i){return{key:t.keyMap[e]||String.fromCharCode(e).toLowerCase(),status:i}}}(this),i=Bacon.fromEventTarget(this.domElement,"keydown").map(function(t){return function(e){return o.call(t,e.keyCode,!0)}}(this)),n=Bacon.fromEventTarget(this.domElement,"keyup").map(function(t){return function(e){return o.call(t,e.keyCode,!1)}}(this)),i.merge(n).filter(function(t){var e;return e=t.key.charCodeAt(0),e>47&&58>e||e>96&&123>e}).onValue(function(t){return function(e){var i;return t.keys[e.key]=e.status,e.status&&null!=(i=t.listener[e.key])?i.forEach(function(t){return t()}):void 0}}(this)),e=[1,2],h=function(t){return function(i){var n;return n={},e.forEach(function(t){return n[t]=[]}),Bacon.fromEventTarget(t.domElement,i).filter(function(t){var i;return i=t.button,r.call(e,i)>=0}).onValue(function(t){return n[t.button].forEach(function(e){return e(t.clientX,t.clientY)})}),[function(t,e){var i;return null!=(i=n[t])?i.push(e):void 0},function(t,e){return _.remove(n[t],function(t){return null!=e?t===e:!0})}]}}(this),u=h("mousedown"),this.onMouseDown=u[0],this.offMouseDown=u[1],a=h("mouseup"),this.onMouseUp=a[0],this.offMouseUp=a[1],c=_.transform(h("dblclick"),function(t,e){return t.push(e.bind(this,1))}),this.onDoubleClick=c[0],this.offDoubleClick=c[1],p=function(t){return function(){var i,n,r,o;return n={},i={},e.forEach(function(t){return i[t]=!1,n[t]=[]}),r=Bacon.fromEventTarget(t.domElement,"mousedown").map(function(t){return[t.button,!0]}),o=Bacon.fromEventTarget(t.domElement,"mouseup").map(function(t){return[t.button,!1]}),r.merge(o).onValue(function(t){return null!=i[t[0]]?i[t[0]]=t[1]:void 0}),Bacon.fromEventTarget(t.domElement,"mousemove").onValue(function(t){var e,r,o;r=[];for(e in n)s.call(n,e)&&(o=n[e],r.push(o.forEach(function(n){return i[e]?n(t.clientX,t.clientY):void 0})));return r}),[function(t,e){var i;return null!=(i=n[t])?i.push(e):void 0},function(t,e){return _.remove(n[t],function(t){return null!=e?t===e:!0})}]}}(this)(),this.onMouseMove=p[0],this.offMouseMove=p[1],this.offAll=function(t){return function(){return e.forEach(function(e){return t.offMouseDown(e),t.offMouseUp(e),t.offMouseMove(e)}),t.offDoubleClick(),t.listener={}}}(this)}return t.prototype.on=function(t,e){return this.listener[t]?this.listener[t].push(e):this.listener[t]=[e]},t.prototype.off=function(t,e){return _.remove(this.listener[t],function(t){return t===e})},t}(),e.exports=n},{}],10:[function(t,e,i){"use strict";var n,r,s;r=t("./view"),s=t("./World"),n=function(){function t(){this.view=new r,this.world=new s(this.view.container,this.view.size)}return t.prototype.loop=function(){return requestAnimationFrame(function(t){return function(){return t.loop()}}(this)),this.view.render(function(t){return function(){return t.world.update()}}(this))},t}(),$(function(){return(new n).loop()})},{"./World":3,"./view":15}],11:[function(t,e,i){e.exports={INIT:0,READY:1,ACTIVE:2,DEAD:3}},{}],12:[function(t,e,i){var n;n=function(){function t(t,e,i,n,r){this.id=t,this.base=e,this.core=i,this.color=n,this.point=null!=r?r:100,this.units=[],this.bullets=[]}return t.prototype.changePoint=function(t){return this.point+=t,this.point=Math.max(0,this.point),this.scoreboradUpdate()},t.prototype.eachMembers=function(t){var e,i,n,r,s;for(n=this.units,r=[],e=0,i=n.length;i>e;e++)s=n[e],r.push(t(s));return r},t}(),e.exports=n},{}],13:[function(t,e,i){var n,r,s,o;n=t("./actions"),r=t("./status"),o=t("./util"),s=function(){function t(t,e,i){this.team=t,this.base=e,this.brain=i,this.pos={x:0,y:0},this.ang=this.team%2?180:0,this.shotang=0,this.hp=10,this.size=.2,this.vel=0,this.shotInterval=0,this.status=r.ACTIVE,this.respawnCount=0}return t.prototype.getCollider=function(){var t,e;return t=[],e=this.ang*Math.PI/180,t.push({x:this.pos.x+this.size*Math.cos(e),y:this.pos.y+this.size*Math.sin(e)}),t},t.prototype.action=function(t,e){var i,r,s,o,h,u,a;for(u=0,r=!1,a=!1,s=[void 0,-90,90,void 0,180,-135,135,180,0,-45,45,0,void 0,-90,90,void 0],o=0,h=t.length;h>o;o++)switch(i=t[o]){case n.MOVE.TOP:u+=1;break;case n.MOVE.BOTTOM:u+=2;break;case n.MOVE.LEFT:u+=4;break;case n.MOVE.RIGHT:u+=8;break;case n.ATTACK.AIM:r=!0,a=!0;break;case n.ATTACK.FOWARD:a=!0}return null!=s[u]?(this.ang=s[u],this.vel=r?.04:.07):this.vel=0,this.shotang=this.ang,this.shotInterval>0&&this.shotInterval--,a&&0===this.shotInterval?(this.shotInterval=20,e(this)):void 0},t.prototype.update=function(t){var e;switch(this.status){case r.READY:0===this.respawnCount?(this.status=r.ACTIVE,this.pos.x=this.base.x+o.randf(1),this.pos.y=this.base.y+o.randf(1),this.hp=10,this.ang=this.team%2?180:0):this.respawnCount--;break;case r.ACTIVE:this.action(this.brain.update(this),t),e=this.ang*Math.PI/180,this.pos.x+=this.vel*Math.cos(e),this.pos.y+=this.vel*Math.sin(e),this.vel=.7*this.vel,this.vel*this.vel<1e-4&&(this.vel=0),this.hp<=0&&(this.status=r.DEAD);break;case r.DEAD:this.pos.x=-100,this.pos.y=-100,this.status=r.READY,this.respawnCount=180}return this.scoreboradUpdate()},t}(),e.exports=s},{"./actions":4,"./status":11,"./util":14}],14:[function(t,e,i){var n;n=function(){function t(){}return t.rand=function(t){return Math.floor(Math.random()*t)},t.randf=function(t){return Math.random()*t},t.randRange=function(t,e){return Math.floor(Math.random()*(e-t+1))+t},t.randArray=function(t){return t[Math.floor(Math.random()*t.length)]},t}(),e.exports=n},{}],15:[function(t,e,i){var n;n=function(){function t(){this.size=640,this.renderer=PIXI.autoDetectRenderer(this.size,this.size,{backgroundColor:0,antialias:!0}),$(document.body).append(this.renderer.view),this.container=new PIXI.Container,this.stats=new Stats,this.stats.setMode(0),this.stats.domElement.style.position="absolute",this.stats.domElement.style.right="0px",this.stats.domElement.style.top="0px",$(document.body).append(this.stats.domElement)}return t.prototype.render=function(t){return this.stats.begin(),t(),this.renderer.render(this.container),this.stats.end()},t}(),e.exports=n},{}]},{},[10]);
//# sourceMappingURL=bundle.js.map