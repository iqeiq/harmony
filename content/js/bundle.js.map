{"version":3,"sources":["node_modules/browserify/node_modules/browser-pack/_prelude.js","bundle.js","node_modules/browserify/node_modules/path-browserify/index.js","node_modules/browserify/node_modules/process/browser.js","src/World.coffee","src/actions.coffee","src/brain.coffee","src/brain/human.coffee","src/brain/standard.coffee","src/input.coffee","src/main.coffee","src/team.coffee","src/unit.coffee","src/util.coffee","src/view.coffee"],"names":["e","t","n","r","s","o","u","a","require","i","f","Error","code","l","exports","call","length",1,"module","process","normalizeArray","parts","allowAboveRoot","up","last","splice","unshift","filter","xs","res","push","splitPathRe","splitPath","filename","exec","slice","resolve","resolvedPath","resolvedAbsolute","arguments","path","cwd","TypeError","charAt","split","p","join","normalize","isAbsolute","trailingSlash","substr","paths","Array","prototype","index","relative","from","to","trim","arr","start","end","fromParts","toParts","Math","min","samePartsLength","outputParts","concat","sep","delimiter","dirname","result","root","dir","basename","ext","extname","str","len","this","_process",2,"cleanUpNextTick","draining","currentQueue","queue","queueIndex","drainQueue","timeout","setTimeout","run","clearTimeout","Item","fun","array","noop","nextTick","args","apply","title","browser","env","argv","version","versions","on","addListener","once","off","removeListener","removeAllListeners","emit","binding","name","chdir","umask",3,"HumanBrain","Input","StandardBrain","Team","Unit","World","util","container","viewsize","size1","b","base","gPause","gStart","humanBrain","j","k","len1","len2","m","mapstr","memberNum","playerTeam","ref","ref1","ref2","ref3","v","x","y","size","input","size2","gridSize","field","Uint8Array","dismap","Int32Array","plInfmap","Float32Array","enInfmap","team","replace","parseInt","some","_this","gField","setupField","addChild","player","addUnit","setupStartView","setupPauseView","scene","init","transit","keys","removeChild","main","pause","gResult","len3","ref4","updateUnits","changePoint","point","offAll","setupResultView","phase","next","bind","g","pos","randf","ang","setupUnit","units","hitCheck","d","rx","ry","floor","fix","unit","poss","rad","results","getCollider","PI","cos","sin","vel","setupText","font","color","stylex","styley","text","PIXI","Text","fill","align","position","width","height","Graphics","lineStyle","beginFill","drawRect","endFill","alpha","isWin","col","text2","draw","g2","filters","BlurFilter","blur","type","moveTo","lineTo","scoreborad","scoreboradUpdate","gs","blendMode","BLEND_MODES","ADD","p0x","p0y","p1x","p1y","p2x","p2y","p3x","p3y","results1","update","rotation","location","reload","./brain/human","./brain/standard","./input","./team","./unit","./util",4,"IDOL","MOVE","TOP","BOTTOM","LEFT","RIGHT","ATTACK","AIM","FOWARD",5,"Brain",6,"ACTION","extend","child","parent","ctor","constructor","key","hasProp","__super__","hasOwnProperty","superClass","acts","../actions","../brain",7,"randArray","../util",8,"indexOf","item","domElement","buttons","keydown","keyup","mapper","mouseEvent","document","listener","keyMap",13,16,17,18,27,32,37,38,39,40,"keycode","status","String","fromCharCode","toLowerCase","Bacon","fromEventTarget","map","keyCode","merge","charCodeAt","onValue","forEach","button","clientX","clientY","btn","cb","_","remove","onMouseDown","offMouseDown","onMouseUp","offMouseUp","transform","onDoubleClick","offDoubleClick","active","md","mu","onMouseMove","offMouseMove",9,"Main","View","view","world","loop","requestAnimationFrame","render","$","./World","./view",10,"id","diff","max","eachMembers",11,"brain","shotang","colls","action","actions","act","aimflag","angs","moveflag","shotflag","./actions",12,"Utility","rand","random","randRange","renderer","autoDetectRenderer","backgroundColor","antialias","body","append","Container","stats","Stats","setMode","style","right","top","updater","begin"],"mappings":"CAAA,QAAAA,GAAAC,EAAAC,EAAAC,GAAA,QAAAC,GAAAC,EAAAC,GAAA,IAAAJ,EAAAG,GAAA,CAAA,IAAAJ,EAAAI,GAAA,CAAA,GAAAE,GAAA,kBAAAC,UAAAA,OAAA,KAAAF,GAAAC,EAAA,MAAAA,GAAAF,GAAA,EAAA,IAAAI,EAAA,MAAAA,GAAAJ,GAAA,EAAA,IAAAK,GAAA,GAAAC,OAAA,uBAAAN,EAAA,IAAA,MAAAK,GAAAE,KAAA,mBAAAF,EAAA,GAAAG,GAAAX,EAAAG,IAAAS,WAAAb,GAAAI,GAAA,GAAAU,KAAAF,EAAAC,QAAA,SAAAd,GAAA,GAAAE,GAAAD,EAAAI,GAAA,GAAAL,EAAA,OAAAI,GAAAF,EAAAA,EAAAF,IAAAa,EAAAA,EAAAC,QAAAd,EAAAC,EAAAC,EAAAC,GAAA,MAAAD,GAAAG,GAAAS,QAAA,IAAA,GAAAL,GAAA,kBAAAD,UAAAA,QAAAH,EAAA,EAAAA,EAAAF,EAAAa,OAAAX,IAAAD,EAAAD,EAAAE,GAAA,OAAAD,KAAAa,GAAA,SAAAT,EAAAU,EAAAJ,ICCA,SAAWK,GCwBX,QAAAC,GAAAC,EAAAC,GAGA,IAAA,GADAC,GAAA,EACAd,EAAAY,EAAAL,OAAA,EAAAP,GAAA,EAAAA,IAAA,CACA,GAAAe,GAAAH,EAAAZ,EACA,OAAAe,EACAH,EAAAI,OAAAhB,EAAA,GACA,OAAAe,GACAH,EAAAI,OAAAhB,EAAA,GACAc,KACAA,IACAF,EAAAI,OAAAhB,EAAA,GACAc,KAKA,GAAAD,EACA,KAAAC,IAAAA,EACAF,EAAAK,QAAA,KAIA,OAAAL,GA+JA,QAAAM,GAAAC,EAAAlB,GACA,GAAAkB,EAAAD,OAAA,MAAAC,GAAAD,OAAAjB,EAEA,KAAA,GADAmB,MACApB,EAAA,EAAAA,EAAAmB,EAAAZ,OAAAP,IACAC,EAAAkB,EAAAnB,GAAAA,EAAAmB,IAAAC,EAAAC,KAAAF,EAAAnB,GAEA,OAAAoB,GAhKA,GAAAE,GACA,gEACAC,EAAA,SAAAC,GACA,MAAAF,GAAAG,KAAAD,GAAAE,MAAA,GAKArB,GAAAsB,QAAA,WAIA,IAAA,GAHAC,GAAA,GACAC,GAAA,EAEA7B,EAAA8B,UAAAvB,OAAA,EAAAP,GAAA,KAAA6B,EAAA7B,IAAA,CACA,GAAA+B,GAAA/B,GAAA,EAAA8B,UAAA9B,GAAAU,EAAAsB,KAGA,IAAA,gBAAAD,GACA,KAAA,IAAAE,WAAA,4CACAF,KAIAH,EAAAG,EAAA,IAAAH,EACAC,EAAA,MAAAE,EAAAG,OAAA,IAWA,MAJAN,GAAAjB,EAAAO,EAAAU,EAAAO,MAAA,KAAA,SAAAC,GACA,QAAAA,KACAP,GAAAQ,KAAA,MAEAR,EAAA,IAAA,IAAAD,GAAA,KAKAvB,EAAAiC,UAAA,SAAAP,GACA,GAAAQ,GAAAlC,EAAAkC,WAAAR,GACAS,EAAA,MAAAC,EAAAV,EAAA,GAcA,OAXAA,GAAApB,EAAAO,EAAAa,EAAAI,MAAA,KAAA,SAAAC,GACA,QAAAA,KACAG,GAAAF,KAAA,KAEAN,GAAAQ,IACAR,EAAA,KAEAA,GAAAS,IACAT,GAAA,MAGAQ,EAAA,IAAA,IAAAR,GAIA1B,EAAAkC,WAAA,SAAAR,GACA,MAAA,MAAAA,EAAAG,OAAA,IAIA7B,EAAAgC,KAAA,WACA,GAAAK,GAAAC,MAAAC,UAAAlB,MAAApB,KAAAwB,UAAA,EACA,OAAAzB,GAAAiC,UAAApB,EAAAwB,EAAA,SAAAN,EAAAS,GACA,GAAA,gBAAAT,GACA,KAAA,IAAAH,WAAA,yCAEA,OAAAG,KACAC,KAAA,OAMAhC,EAAAyC,SAAA,SAAAC,EAAAC,GAIA,QAAAC,GAAAC,GAEA,IADA,GAAAC,GAAA,EACAA,EAAAD,EAAA3C,QACA,KAAA2C,EAAAC,GADAA,KAKA,IADA,GAAAC,GAAAF,EAAA3C,OAAA,EACA6C,GAAA,GACA,KAAAF,EAAAE,GADAA,KAIA,MAAAD,GAAAC,KACAF,EAAAxB,MAAAyB,EAAAC,EAAAD,EAAA,GAfAJ,EAAA1C,EAAAsB,QAAAoB,GAAAN,OAAA,GACAO,EAAA3C,EAAAsB,QAAAqB,GAAAP,OAAA,EAsBA,KAAA,GALAY,GAAAJ,EAAAF,EAAAZ,MAAA,MACAmB,EAAAL,EAAAD,EAAAb,MAAA,MAEA5B,EAAAgD,KAAAC,IAAAH,EAAA9C,OAAA+C,EAAA/C,QACAkD,EAAAlD,EACAP,EAAA,EAAAO,EAAAP,EAAAA,IACA,GAAAqD,EAAArD,KAAAsD,EAAAtD,GAAA,CACAyD,EAAAzD,CACA,OAKA,IAAA,GADA0D,MACA1D,EAAAyD,EAAAzD,EAAAqD,EAAA9C,OAAAP,IACA0D,EAAArC,KAAA,KAKA,OAFAqC,GAAAA,EAAAC,OAAAL,EAAA5B,MAAA+B,IAEAC,EAAArB,KAAA,MAGAhC,EAAAuD,IAAA,IACAvD,EAAAwD,UAAA,IAEAxD,EAAAyD,QAAA,SAAA/B,GACA,GAAAgC,GAAAxC,EAAAQ,GACAiC,EAAAD,EAAA,GACAE,EAAAF,EAAA,EAEA,OAAAC,IAAAC,GAKAA,IAEAA,EAAAA,EAAAxB,OAAA,EAAAwB,EAAA1D,OAAA,IAGAyD,EAAAC,GARA,KAYA5D,EAAA6D,SAAA,SAAAnC,EAAAoC,GACA,GAAAlE,GAAAsB,EAAAQ,GAAA,EAKA,OAHAoC,IAAAlE,EAAAwC,OAAA,GAAA0B,EAAA5D,UAAA4D,IACAlE,EAAAA,EAAAwC,OAAA,EAAAxC,EAAAM,OAAA4D,EAAA5D,SAEAN,GAIAI,EAAA+D,QAAA,SAAArC,GACA,MAAAR,GAAAQ,GAAA,GAaA,IAAAU,GAAA,MAAA,KAAAA,OAAA,IACA,SAAA4B,EAAAlB,EAAAmB,GAAA,MAAAD,GAAA5B,OAAAU,EAAAmB,IACA,SAAAD,EAAAlB,EAAAmB,GAEA,MADA,GAAAnB,IAAAA,EAAAkB,EAAA9D,OAAA4C,GACAkB,EAAA5B,OAAAU,EAAAmB,MDMGhE,KAAKiE,KAAKxE,EAAQ,eAElByE,SAAW,IAAIC,GAAG,SAAS1E,EAAQU,EAAOJ,GE7N7C,QAAAqE,KACAC,GAAA,EACAC,EAAArE,OACAsE,EAAAD,EAAAjB,OAAAkB,GAEAC,EAAA,GAEAD,EAAAtE,QACAwE,IAIA,QAAAA,KACA,IAAAJ,EAAA,CAGA,GAAAK,GAAAC,WAAAP,EACAC,IAAA,CAGA,KADA,GAAAL,GAAAO,EAAAtE,OACA+D,GAAA,CAGA,IAFAM,EAAAC,EACAA,OACAC,EAAAR,GACAM,GACAA,EAAAE,GAAAI,KAGAJ,GAAA,GACAR,EAAAO,EAAAtE,OAEAqE,EAAA,KACAD,GAAA,EACAQ,aAAAH,IAiBA,QAAAI,GAAAC,EAAAC,GACAf,KAAAc,IAAAA,EACAd,KAAAe,MAAAA,EAYA,QAAAC,MAtEA,GAGAX,GAHAlE,EAAAD,EAAAJ,WACAwE,KACAF,GAAA,EAEAG,EAAA,EAsCApE,GAAA8E,SAAA,SAAAH,GACA,GAAAI,GAAA,GAAA9C,OAAAb,UAAAvB,OAAA,EACA,IAAAuB,UAAAvB,OAAA,EACA,IAAA,GAAAP,GAAA,EAAAA,EAAA8B,UAAAvB,OAAAP,IACAyF,EAAAzF,EAAA,GAAA8B,UAAA9B,EAGA6E,GAAAxD,KAAA,GAAA+D,GAAAC,EAAAI,IACA,IAAAZ,EAAAtE,QAAAoE,GACAM,WAAAF,EAAA,IASAK,EAAAxC,UAAAsC,IAAA,WACAX,KAAAc,IAAAK,MAAA,KAAAnB,KAAAe,QAEA5E,EAAAiF,MAAA,UACAjF,EAAAkF,SAAA,EACAlF,EAAAmF,OACAnF,EAAAoF,QACApF,EAAAqF,QAAA,GACArF,EAAAsF,YAIAtF,EAAAuF,GAAAV,EACA7E,EAAAwF,YAAAX,EACA7E,EAAAyF,KAAAZ,EACA7E,EAAA0F,IAAAb,EACA7E,EAAA2F,eAAAd,EACA7E,EAAA4F,mBAAAf,EACA7E,EAAA6F,KAAAhB,EAEA7E,EAAA8F,QAAA,SAAAC,GACA,KAAA,IAAAvG,OAAA,qCAGAQ,EAAAsB,IAAA,WAAA,MAAA,KACAtB,EAAAgG,MAAA,SAAAzC,GACA,KAAA,IAAA/D,OAAA,mCAEAQ,EAAAiG,MAAA,WAAA,MAAA,SFwOMC,GAAG,SAAS7G,EAAQU,EAAOJ,GGlUjC,GAAAwG,GAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAnF,EAAAoF,CAAApF,GAAOhC,EAAQ,QAGfoH,EAAOpH,EAAQ,UACf+G,EAAQ/G,EAAQ,WAChBkH,EAAOlH,EAAQ,UACfiH,EAAOjH,EAAQ,UACf8G,EAAa9G,EAAQ,iBACrBgH,EAAgBhH,EAAQ,oBAGlBmH,EAAA,WAES,QAAAA,GAACE,EAAYC,EAAWC,GACnC,GAAAC,GAAAC,EAAAC,EAAAC,EAAAC,EAAA3H,EAAA4H,EAAAC,EAAAzH,EAAAkE,EAAAwD,EAAAC,EAAAC,EAAAC,EAAAC,EAAAzI,EAAA0I,EAAAC,EAAAC,EAAAC,EAAAC,EAAA/I,EAAAK,EAAA2I,EAAAC,EAAAC,CAeA,KAhBYnE,KAAC6C,UAADA,EAAY7C,KAAC8C,SAADA,EAAW9C,KAACoE,KAAA,MAAArB,EAADA,EAAQ,GAC3C/C,KAACqE,MAAQ,GAAI9B,GACbvC,KAACsE,MAAQtE,KAACoE,KAAOpE,KAACoE,KAClBpE,KAACuE,SAAWvE,KAAC8C,SAAW9C,KAACoE,KAEzBpE,KAACwE,MAAY,GAAAC,YAAWzE,KAACsE,OACzBtE,KAAC0E,OAAa,GAAAC,YAAW3E,KAACsE,OAC1BtE,KAAC4E,SAAe,GAAAC,cAAa7E,KAACsE,OAC9BtE,KAAC8E,SAAe,GAAAD,cAAa7E,KAACsE,OAE9BV,EAAa,EACb5D,KAAC+E,QACD9B,UAEAS,EAAS,+nCACTA,EAASA,EAAOsB,QAAQ,SAAU,IAClCnB,EAAA7D,KAAAwE,MAAA/I,EAAA4H,EAAA,EAAAtD,EAAA8D,EAAA7H,OAAA+D,EAAAsD,EAAA5H,IAAA4H,EAIE,OHwUAY,EAAIJ,EAAIpI,GG3URuE,KAACwE,MAAM/I,GAAKwJ,SAASvB,EAAO/F,OAAOlC,IACnCyI,EAAIzI,EAAIuE,KAACoE,KACTD,EAAI1I,EAAIuE,KAACoE,KAAO,EACTpE,KAACwE,MAAM/I,IAAd,IACO,GAAOwH,EAAK,IAAMiB,EAAGA,EAAGC,EAAGA,EAA3B,MADP,KAEO,GAAOlB,EAAK,IAAMiB,EAAGA,EAAGC,EAAGA,GAKpC,IAHAnE,KAAC+E,KAAKjI,KAAS,GAAA2F,GAAK,EAAGQ,EAAK,GAAI,WAChCjD,KAAC+E,KAAKjI,KAAS,GAAA2F,GAAK,EAAGQ,EAAK,GAAI,QAEhCa,EAAA9D,KAAA0E,OAAAjJ,EAAAI,EAAA,EAAA0H,EAAAO,EAAA9H,OAAAuH,EAAA1H,EAAAJ,IAAAI,EHuVEoI,EAAIH,EAAKrI,GGtVTuE,KAAC0E,OAAOjJ,IAAS,EAAG,EAAG,EAAG,GAAGyJ,KAAK,SAAAC,GHwVhC,MGxVgC,UAAClB,GHyV/B,MGzVoCkB,GAACX,MAAM/I,KAAMwI,IAAnBjE,OAA2B,EAAO,EAStE,KAPAA,KAACoF,OAASpF,KAACqF,aACXrF,KAAC6C,UAAUyC,SAAStF,KAACoF,QAErBhC,EAAiB,GAAAd,GAAWtC,KAACqE,OAC7BrE,KAACuF,OAAa,GAAA7C,GAAKkB,EAAYR,GAC/BpD,KAACwF,QAAQxF,KAACuF,QAEVxB,EAAA/D,KAAA+E,KAAAtJ,EAAAgI,EAAA,EAAAD,EAAAO,EAAA/H,OAAAwH,EAAAC,EAAAhI,IAAAgI,EAEE,IHyVAxI,EAAI8I,EAAKtI,GG1VTkI,EAAeC,IAAcnI,EAAO,EAAO,EAClC6H,EAAApI,EAAA,EAAA8I,EAAAL,EAAAK,GAAA,EAAAA,EAAA9I,EAAAA,EAAA8I,EAAAV,EAAAU,GAAA,IAAA9I,IAAAA,EACP8H,EAAI,GAAIR,GACRlH,EAAQ,GAAAoH,GAAKjH,EAAGuH,GAChBhD,KAACwF,QAAQlK,EAGb6H,GAASnD,KAACyF,iBACVzF,KAAC6C,UAAUyC,SAASnC,GAEpBD,EAASlD,KAAC0F,iBAEV1F,KAAC2F,SACD3F,KAAC2F,MAAMC,KAAO,SAAAT,GH0VZ,MG1VY,YH2VV,MG1VF,UAACU,GACC,MAAGV,GAACd,MAAMyB,KAAK,GACbX,EAACtC,UAAUkD,YAAY5C,GACvB0C,EAAQ,SAFV,UAFU7F,MAMdA,KAAC2F,MAAMK,KAAO,SAAAb,GH8VZ,MG9VY,YACZ,GAAAc,EHwWE,OGxWFA,IAAQ,EACRd,EAACd,MAAM3C,GAAG,QAAS,WAEjB,MADAuE,IAAYA,EACTA,EACDd,EAACtC,UAAUyC,SAASpC,GAEpBiC,EAACtC,UAAUkD,YAAY7C,KAC3B,SAAC2C,GACC,GAAAK,GAAAC,EAAA9K,EAAA+K,EAAA5G,CAAA,KAAUyG,EAAV,CAMA,IALAd,EAACkB,cAC4BlB,EAACd,MAAMyB,KAAK,GAAzCX,EAACJ,KAAK,GAAGuB,YAAY,MACQnB,EAACd,MAAMyB,KAAK,GAAzCX,EAACJ,KAAK,GAAGuB,YAAY,MAErB9G,EAAS,OACT4G,EAAAjB,EAAAJ,KAAAtJ,EAAAJ,EAAA,EAAA8K,EAAAC,EAAApK,OAAAmK,EAAA9K,EAAAI,IAAAJ,EACE,GHwWEJ,EAAImL,EAAK3K,GGxWG,IAAXR,EAAEsL,MAAL,CACE/G,EAAY/D,IAAKmI,GAAgB,GAAW,CAC5C,OAEJ,MAAe,UAAZpE,GACD2F,EAACd,MAAMmC,SACPN,EAAUf,EAACsB,gBAAgBjH,GAC3B2F,EAACtC,UAAUyC,SAASY,GACpBL,EAAQ,WAJV,WApBU7F,MA0BdA,KAAC2F,MAAMnG,OAAS,SAAA2F,GH8Wd,MG9Wc,YH+WZ,MG9WF,UAACU,OADa7F,MAGhBA,KAAC0G,MAAQ,KACT1G,KAAC6F,QAAU,SAAAV,GHgXT,MGhXS,UAACwB,GHiXR,MGjXgBxB,GAACuB,MAAQvB,EAACQ,MAAMgB,KAAQC,KAAKzB,EAAGA,EAACU,WAA1C7F,MAEXA,KAAC6F,QAAQ,QH2nBX,MAtQAlD,GAAMtE,UGlXNmH,QAAS,SAAClK,GACR,GAAAuL,GAAAhD,EAAA5I,EAAAiJ,EAAAC,CH0XA,OG1XAlJ,GAAIK,EAAEyJ,KACNlB,EAAS7D,KAAC+E,KAAK9J,GAAGgI,KAAjBiB,EAAAL,EAAAK,EAAGC,EAAAN,EAAAM,EACJ7I,EAAEwL,IAAI5C,EAAIA,EAAItB,EAAKmE,MAAM,GACzBzL,EAAEwL,IAAI3C,EAAIA,EAAIvB,EAAKmE,MAAM,GACzBzL,EAAE0L,IAAS/L,EAAI,EAAO,IAAS,EAC/B4L,EAAI7G,KAACiH,UAAU3L,GACf0E,KAAC6C,UAAUyC,SAASuB,GACpB7G,KAAC+E,KAAK9J,GAAGiM,MAAMpK,MACbrB,EAAGH,EACHuL,EAAGA,KHuXPlE,EAAMtE,UGrXN8I,SAAU,SAACjD,EAAGC,GACZ,GAAAiD,GAAA9I,EAAA+I,EAAAC,CAAA,OAAiB,GAAJpD,GAAe,GAAJC,EAAjB,GACMD,EAAIlE,KAACoE,KAAO,IAAOD,EAAInE,KAACoE,KAAO,GAArC,IACP9F,EAAQU,KAAKuI,MAAMrD,EAAI,IAAOlE,KAACoE,KAAOpF,KAAKuI,MAAMpD,EAAI,IACrDkD,EAAKnD,EAAI,GAAMlF,KAAKuI,MAAMrD,EAAI,IAC9BoD,EAAKnD,EAAI,GAAMnF,KAAKuI,MAAMpD,EAAI,IACf,KAALkD,IAAVA,EAAK,GACU,KAALC,IAAVA,EAAK,GACLF,GACEpH,KAAC0E,OAAOpG,GACR0B,KAAC0E,OAAOpG,EAAQ,GAChB0B,KAAC0E,OAAOpG,EAAQ0B,KAACoE,MACjBpE,KAAC0E,OAAOpG,EAAQ0B,KAACoE,KAAO,KAElB,EAAIiD,IAAO,EAAIC,GAAMF,EAAE,IAAM,EAAIC,GAAMC,EAAKF,EAAE,GAAKC,GAAM,EAAIC,GAAMF,EAAE,GAAKC,EAAKC,EAAKF,EAAE,KH4XhGzE,EAAMtE,UG1XNmJ,IAAK,SAACC,GACJ,GAAAL,GAAA/D,EAAAtD,EAAAlC,EAAA6J,EAAAC,EAAAC,CH6XA,KG7XAF,EAAOD,EAAKI,cACZD,KAAAvE,EAAA,EAAAtD,EAAA2H,EAAA1L,OAAA+D,EAAAsD,EAAAA,IH6XExF,EAAI6J,EAAKrE,GG5XT+D,EAAIpH,KAACmH,SAAStJ,EAAEqG,EAAGrG,EAAEsG,GACd,EAAJiD,GACDO,GAAOF,EAAKT,IAAM,KAAOhI,KAAK8I,GAAK,IACnCL,EAAKX,IAAI5C,GAAKkD,EAAIpI,KAAK+I,IAAIJ,GAC3BF,EAAKX,IAAI3C,GAAKiD,EAAIpI,KAAKgJ,IAAIL,GH8X3BC,EAAQ9K,KG7XR2K,EAAKQ,IAAM,IH+XXL,EAAQ9K,KAAK,OAGjB,OAAO8K,IAGTjF,EAAMtE,UGnYN6J,UAAW,SAAChE,EAAGC,EAAGrE,EAAKqI,EAAMC,EAAOC,EAAQC,GAC1C,GAAAC,EAIA,QAJAA,EAAW,GAAAC,MAAKC,KAAK3I,GACnBqI,KAAMA,EACNO,KAAMN,EACNO,MAAON,IACFA,GAAP,IACO,SACHE,EAAKK,SAAS1E,EAAIA,EAAIqE,EAAKM,MAAQ,CADhC,MADP,KAGO,QACHN,EAAKK,SAAS1E,EAAIA,EAAIqE,EAAKM,MAC/B,OAAOP,GAAP,IACO,SACHC,EAAKK,SAASzE,EAAIA,EAAIoE,EAAKO,OAAS,CADjC,MADP,KAGO,SACHP,EAAKK,SAASzE,EAAIA,EAAIoE,EAAKO,OAC/B,MAAOP,IH4YT5F,EAAMtE,UG1YNoH,eAAgB,WACd,GAAAoB,GAAA0B,CAUA,OAVA1B,GAAI,GAAI2B,MAAKO,SACblC,EAAEmC,UAAU,GACTC,UAAU,SACVC,SAAS,EAAG,EAAGlJ,KAAC8C,SAAU9C,KAAC8C,UAC3BqG,UACHtC,EAAEuC,MAAQ,GAEVb,EAAOvI,KAACkI,UAAUlI,KAAC8C,SAAW,EAAG9C,KAAC8C,SAAW,EAAG,UAAW,eAAgB,SAAU,SAAU,UAC/F+D,EAAEvB,SAASiD,GAEJ1B,GHyYTlE,EAAMtE,UGvYNqH,eAAgB,WACd,GAAAmB,GAAA0B,CAUA,OAVA1B,GAAI,GAAI2B,MAAKO,SACblC,EAAEmC,UAAU,GACTC,UAAU,SACVC,SAAS,EAAG,EAAGlJ,KAAC8C,SAAU9C,KAAC8C,UAC3BqG,UACHtC,EAAEuC,MAAQ,GAEVb,EAAOvI,KAACkI,UAAUlI,KAAC8C,SAAW,EAAG9C,KAAC8C,SAAW,EAAG,QAAS,eAAgB,SAAU,SAAU,UAC7F+D,EAAEvB,SAASiD,GAEJ1B,GHsYTlE,EAAMtE,UGpYNoI,gBAAiB,SAAC4C,GAChB,GAAAC,GAAAzC,EAAA/G,EAAAyI,EAAAgB,CAcA,OAdA1C,GAAI,GAAI2B,MAAKO,SACblC,EAAEmC,UAAU,GACTC,UAAU,SACVC,SAAS,EAAG,EAAGlJ,KAAC8C,SAAU9C,KAAC8C,UAC3BqG,UACHtC,EAAEuC,MAAQ,GACVE,EAASD,EAAW,SAAc,MAClCvJ,EAASuJ,EAAW,UAAe,WACnCd,EAAOvI,KAACkI,UAAUlI,KAAC8C,SAAW,EAAG9C,KAAC8C,SAAW,EAAGhD,EAAK,eAAgBwJ,EAAK,SAAU,UACpFzC,EAAEvB,SAASiD,GAEXgB,EAAQvJ,KAACkI,UAAUlI,KAAC8C,SAAW,EAAe,EAAZ9C,KAAC8C,SAAe,EAAG,sBAAuB,eAAgB,SAAU,SAAU,UAChH+D,EAAEvB,SAASiE,GAEJ1C,GHmYTlE,EAAMtE,UGjYNgH,WAAY,WACV,GAAAiE,GAAAE,EAAA7M,EAAAkK,EAAA4C,EAAApG,EAAAtD,EAAA8D,EAAA/D,EAAA7E,EAAAiJ,EAAAC,CAsCA,KAtCA0C,EAAI,GAAI2B,MAAKO,SACbU,EAAK,GAAIjB,MAAKO,SACdpM,EAAS,GAAI6L,MAAKkB,QAAQC,WAC1BhN,EAAOiN,KAAO,EAEdJ,EAAO,SAAArE,GHkYL,MGlYK,UAAC0E,EAAMhB,EAAOT,GAEnB,GAAAhB,GAAA1L,EAAAD,EAAA4H,EAAAtD,EAAAlC,EAAAgG,EAAA+D,EAAA3D,EAAAC,EAAAC,CHoYE,KGpYFN,EAAAsB,EAAAT,OAAAkD,KAAAnM,EAAA4H,EAAA,EAAAtD,EAAA8D,EAAA7H,OAAA+D,EAAAsD,EAAA5H,IAAA4H,EAGE,GHkYEY,EAAIJ,EAAIpI,GGpYVyI,EAAIzI,EAAI0J,EAACf,KACTD,EAAI1I,EAAI0J,EAACf,KAAO,IACJF,EAAIiB,EAACf,KAAO,GAAxB,CACA,GAASD,EAAIgB,EAACf,KAAO,EAArB,KACAgD,IAAKjC,EAACT,OAAOjJ,GAAI0J,EAACT,OAAOjJ,EAAI,GAAI0J,EAACT,OAAOjJ,EAAI0J,EAACf,MAAOe,EAACT,OAAOjJ,EAAI0J,EAACf,KAAO,IACzE1I,GAAKyJ,EAACX,MAAM/I,GAAI0J,EAACX,MAAM/I,EAAI,GAAI0J,EAACX,MAAM/I,EAAI0J,EAACf,MAAOe,EAACX,MAAM/I,EAAI0J,EAACf,KAAO,IAErD1I,EAAEwJ,KAAK,SAACjB,GHyYpB,MGzYyBA,KAAK4F,MAElChM,KAC6BuJ,EAAE,GAAKA,EAAE,GAAK,GAA3CvJ,EAAEf,MAAMoH,EAAGA,EAAI,GAAKC,EAAGA,IACMiD,EAAE,GAAKA,EAAE,GAAK,GAA3CvJ,EAAEf,MAAMoH,EAAGA,EAAGC,EAAGA,EAAI,KACciD,EAAE,GAAKA,EAAE,GAAK,GAAjDvJ,EAAEf,MAAMoH,EAAGA,EAAI,EAAKC,EAAGA,EAAI,KACQiD,EAAE,GAAKA,EAAE,GAAK,GAAjDvJ,EAAEf,MAAMoH,EAAGA,EAAI,GAAKC,EAAGA,EAAI,IACC,IAAZtG,EAAE7B,SAElB6K,EAAEmC,UAAUH,EAAOT,GAChB0B,QAAQjM,EAAE,GAAGqG,EAAI,IAAOiB,EAACZ,UAAW1G,EAAE,GAAGsG,EAAI,IAAOgB,EAACZ,UACrDwF,QAAQlM,EAAE,GAAGqG,EAAI,IAAOiB,EAACZ,UAAW1G,EAAE,GAAGsG,EAAI,IAAOgB,EAACZ,UH+ZtDqD,EAAQ9K,KG7ZV2M,EAAGT,UAAkB,EAARH,EAAWT,GACrB0B,QAAQjM,EAAE,GAAGqG,EAAI,IAAOiB,EAACZ,UAAW1G,EAAE,GAAGsG,EAAI,IAAOgB,EAACZ,UACrDwF,QAAQlM,EAAE,GAAGqG,EAAI,IAAOiB,EAACZ,UAAW1G,EAAE,GAAGsG,EAAI,IAAOgB,EAACZ,aH6ZxD,MAAOqD,KGtbJ5H,MA2BPwJ,EAAK,EAAG,EAAG,OACXA,EAAK,EAAG,EAAG,UACXA,EAAK,EAAG,EAAG,UACXA,EAAK,EAAG,EAAG,OACXA,EAAK,EAAG,EAAG,OAEX3F,EAAA7D,KAAA+E,KAAA1B,EAAA,EAAAtD,EAAA8D,EAAA7H,OAAA+D,EAAAsD,EAAAA,IH+ZEpI,EAAI4I,EAAIR,GG9ZRvD,EAAM,GAAG7E,EAAEsL,MACX+C,EAAM,SACNpF,GAAKjJ,EAAEgI,KAAKiB,EAAI,IAAOlE,KAACuE,SACxBJ,GAAKlJ,EAAEgI,KAAKkB,EAAI,IAAOnE,KAACuE,SACxBtJ,EAAE+O,WAAahK,KAACkI,UAAUhE,EAAGC,EAAGrE,EAAK,eAAgBwJ,EAAK,SAAU,UACpErO,EAAE+O,WAAWZ,MAAQ,GACrBnO,EAAEgP,iBAAsB,SAAA9E,GHgatB,MGhasB,YACtB,GAAA+E,EHkaE,OGlaFA,GAAK/E,EAACZ,SACN,WHqaI,MGpaFL,IAAKlE,KAACiD,KAAKiB,EAAI,IAAOgG,EACtB/F,GAAKnE,KAACiD,KAAKkB,EAAI,IAAO+F,EACtBlK,KAACgK,WAAWpB,SAAS1E,EAAIA,EAAIlE,KAACgK,WAAWnB,MAAQ,EACjD7I,KAACgK,WAAWpB,SAASzE,EAAIA,EAAInE,KAACgK,WAAWlB,OAAS,KAN9B9I,QAQxB6G,EAAEvB,SAASrK,EAAE+O,WASf,OAPAnD,GAAEsD,UAAY3B,KAAK4B,YAAYC,IAC/BxD,EAAEuC,MAAQ,GACVK,EAAGL,MAAQ,GACXK,EAAGC,SAAW/M,GAEdkK,EAAEvB,SAASmE,GAEJ5C,GHoaTlE,EAAMtE,UGlaN4I,UAAW,SAACQ,GACV,GAAAZ,GAAAyD,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAlD,EAAAvD,CA2BA,OA3BAyC,GAAI,GAAI2B,MAAKO,SAEbuB,EAAM7C,EAAKX,IAAI5C,EAAIlE,KAACuE,SACpBgG,EAAM9C,EAAKX,IAAI3C,EAAInE,KAACuE,SACpBH,EAAOqD,EAAKrD,KAAOpE,KAACuE,SAEpBiG,EAAMpG,EACNqG,EAAM,EAEN9C,EAAM,KAAO3I,KAAK8I,GAAK,IACvB4C,EAAMtG,EAAOpF,KAAK+I,IAAIJ,GACtBgD,EAAMvG,EAAOpF,KAAKgJ,IAAIL,GAEtBA,EAAM,IAAM3I,KAAK8I,GAAK,IACtB8C,EAAMxG,EAAOpF,KAAK+I,IAAIJ,GACtBkD,EAAMzG,EAAOpF,KAAKgJ,IAAIL,GAEtBd,EAAEmC,UAAU,EAAGhJ,KAAC+E,KAAK0C,EAAK1C,MAAMqD,OAC7B0B,OAAOU,EAAKC,GACZV,OAAOW,EAAKC,GACZZ,OAAO,EAAG,GACVA,OAAOa,EAAKC,GACZd,OAAOS,EAAKC,GAEf5D,EAAE+B,SAAS1E,EAAIoG,EACfzD,EAAE+B,SAASzE,EAAIoG,EAER1D,GH0ZTlE,EAAMtE,UGxZNgI,YAAa,WACX,GAAAhD,GAAAtD,EAAA8D,EAAA+D,EAAA3M,EAAAK,CH2ZA,KG3ZAuI,EAAA7D,KAAA+E,KAAA6C,KAAAvE,EAAA,EAAAtD,EAAA8D,EAAA7H,OAAA+D,EAAAsD,EAAAA,IH4ZEpI,EAAI4I,EAAIR,GACRuE,EAAQ9K,KAAK,WACX,GAAIjB,GAAG0H,EAAMO,EAAMgH,CAGnB,KGhaFhH,EAAA7I,EAAAiM,MAAA4D,KAAAjP,EAAA,EAAA0H,EAAAO,EAAA9H,OAAAuH,EAAA1H,EAAAA,IHiaIP,EAAIwI,EAAKjI,GGhaXP,EAAEG,EAAEsP,SACJ/K,KAACwH,IAAIlM,EAAEG,GACPH,EAAEuL,EAAE+B,SAAS1E,EAAI5I,EAAEG,EAAEqL,IAAI5C,EAAIlE,KAACuE,SAC9BjJ,EAAEuL,EAAE+B,SAASzE,EAAI7I,EAAEG,EAAEqL,IAAI3C,EAAInE,KAACuE,SHka5BuG,EAAShO,KGjaXxB,EAAEuL,EAAEmE,SAAW1P,EAAEG,EAAEuL,IAAMhI,KAAK8I,GAAK,IHmanC,OAAOgD,IACN/O,KAAKiE,MAEV,OAAO4H,IAGTjF,EAAMtE,UGvaN0M,OAAQ,WH2aN,MG1aqB/K,MAACqE,MAAMyB,KAAK,KAAjCmF,SAASC,SACTlL,KAAC0G,SH4aI/D,KG1aTzG,EAAOJ,QAAU6G,IHibdwI,gBAAgB,EAAEC,mBAAmB,EAAEC,UAAU,EAAEC,SAAS,GAAGC,SAAS,GAAGC,SAAS,GAAGhO,KAAO,IAAIiO,GAAG,SAASjQ,EAAQU,EAAOJ,GIxuBhII,EAAOJ,SACL4P,KAAM,EACNC,MACEC,IAAQ,EACRC,OAAQ,EACRC,KAAQ,EACRC,MAAQ,GACVC,QACEC,IAAQ,EACRC,OAAQ,SJ+uBNC,GAAG,SAAS3Q,EAAQU,EAAOJ,GKxvBjC,GAAAsQ,EAAMA,GAAA,WACS,QAAAA,ML+vBb,MAFAA,GAAM/N,UK1vBN0M,OAAQ,SAACtD,KL4vBF2E,KKzvBTlQ,EAAOJ,QAAUsQ,OLgwBXC,GAAG,SAAS7Q,EAAQU,EAAOJ,GMvwBjC,GAAAwQ,GAAAF,EAAA9J,EAAAiK,EAAA,SAAAC,EAAAC,GAAA,QAAAC,KAAA1M,KAAA2M,YAAAH,EAAA,IAAA,GAAAI,KAAAH,GAAAI,EAAA9Q,KAAA0Q,EAAAG,KAAAJ,EAAAI,GAAAH,EAAAG,GAAA,OAAAF,GAAArO,UAAAoO,EAAApO,UAAAmO,EAAAnO,UAAA,GAAAqO,GAAAF,EAAAM,UAAAL,EAAApO,UAAAmO,GN0wBEK,KAAaE,cM1wBfX,GAAQ5Q,EAAQ,YAChB8Q,EAAS9Q,EAAQ,cAEX8G,EAAA,SAAA0K,GACS,QAAA1K,GAAC+B,GAAArE,KAACqE,MAADA,EACZ/B,EAAAwK,UAAAH,YAAA5Q,KAAAiE,MNyyBF,MA7BAuM,GAAOjK,EAAY0K,GAOnB1K,EAAWjE,UMhxBX0M,OAAQ,SAACtD,GACP,GAAAwF,ENkyBA,OMlyBA3K,GAAAwK,UAAA/B,OAAAhP,KAAAiE,KAAMyH,GACNwF,KAEGjN,KAACqE,MAAMyB,KAAK,IACbmH,EAAKnQ,KAAKwP,EAAOX,KAAKC,KACrB5L,KAACqE,MAAMyB,KAAK,MACbmH,EAAKnQ,KAAKwP,EAAOX,KAAKE,QACrB7L,KAACqE,MAAMyB,KAAK,OACbmH,EAAKnQ,KAAKwP,EAAOX,KAAKI,OACrB/L,KAACqE,MAAMyB,KAAK,MACbmH,EAAKnQ,KAAKwP,EAAOX,KAAKG,MACrB9L,KAACqE,MAAMyB,KAAK,GACbmH,EAAKnQ,KAAKwP,EAAON,OAAOC,KAG1BgB,GNsxBK3K,GM3yBgB8J,GAuBzBlQ,EAAOJ,QAAUwG,IN2xBd4K,aAAa,EAAEC,WAAW,IAAIC,GAAG,SAAS5R,EAAQU,EAAOJ,GOrzB5D,GAAAwQ,GAAAF,EAAA5J,EAAAI,EAAA2J,EAAA,SAAAC,EAAAC,GAAA,QAAAC,KAAA1M,KAAA2M,YAAAH,EAAA,IAAA,GAAAI,KAAAH,GAAAI,EAAA9Q,KAAA0Q,EAAAG,KAAAJ,EAAAI,GAAAH,EAAAG,GAAA,OAAAF,GAAArO,UAAAoO,EAAApO,UAAAmO,EAAAnO,UAAA,GAAAqO,GAAAF,EAAAM,UAAAL,EAAApO,UAAAmO,GPwzBEK,KAAaE,cOxzBfnK,GAAOpH,EAAQ,WACf4Q,EAAQ5Q,EAAQ,YAChB8Q,EAAS9Q,EAAQ,cAEXgH,EAAA,SAAAwK,GACS,QAAAxK,KACXA,EAAAsK,UAAAH,YAAA5Q,KAAAiE,MPy0BF,MAdAuM,GAAO/J,EAAewK,GAMtBxK,EAAcnE,UO9zBd0M,OAAQ,SAACtD,GACP,GAAAwF,EAUA,OAVAzK,GAAAsK,UAAA/B,OAAAhP,KAAAiE,KAAMyH,GACNwF,KAEAA,EAAKnQ,KAAK8F,EAAKyK,WACbf,EAAOX,KAAKC,IACZU,EAAOX,KAAKE,OACZS,EAAOX,KAAKG,KACZQ,EAAOX,KAAKI,SAGPkB,GP2zBFzK,GO30BmB4J,GAkB5BlQ,EAAOJ,QAAU0G,IPg0Bd0K,aAAa,EAAEC,WAAW,EAAEG,UAAU,KAAKC,GAAG,SAAS/R,EAAQU,EAAOJ,GQt1BzE,GAAAyG,GAAAiL,KAAAA,SAAA,SAAAC,GAAA,IAAA,GAAAhS,GAAA,EAAAI,EAAAmE,KAAAhE,OAAAH,EAAAJ,EAAAA,IAAA,GAAAA,IAAAuE,OAAAA,KAAAvE,KAAAgS,EAAA,MAAAhS,EAAA,OAAA,IRy1BEoR,KAAaE,cQz1BTxK,GAAA,WACS,QAAAA,GAACmL,GACZ,GAAAC,GAAAC,EAAAC,EAAAC,EAAAC,EAAAlK,EAAAC,EAAAC,EAAAC,CADYhE,MAAC0N,WAAA,MAAAA,EAADA,EAAcM,SAC1BhO,KAAC8F,QACD9F,KAACiO,YAEDjO,KAACkO,QACCX,EAAG,YACHY,GAAI,QACJC,GAAI,QACJC,GAAI,OACJC,GAAI,MACJC,GAAI,MACJC,GAAI,QACJC,GAAI,OACJC,GAAI,KACJC,GAAI,QACJC,GAAI,QAENd,EAAS,SAAA3I,GR61BP,MQ71BO,UAAC0J,EAASC,GR81Bf,OQ71BFlC,IAAKzH,EAAC+I,OAAOW,IAAYE,OAAOC,aAAaH,GAASI,cACtDH,OAAQA,KAFD9O,MAIT4N,EAAUsB,MAAMC,gBAAgBnP,KAAC0N,WAAY,WAAW0B,IAAI,SAAAjK,GRi2B1D,MQj2B0D,UAACnK,GRk2BzD,MQl2B8D8S,GAAO/R,KAAKoJ,EAAGnK,EAAEqU,SAAS,KAAhCrP,OAC5D6N,EAAQqB,MAAMC,gBAAgBnP,KAAC0N,WAAY,SAAS0B,IAAI,SAAAjK,GRq2BtD,MQr2BsD,UAACnK,GRs2BrD,MQt2B0D8S,GAAO/R,KAAKoJ,EAAGnK,EAAEqU,SAAS,KAAhCrP,OACxD4N,EAAQ0B,MAAMzB,GAAOlR,OAAO,SAAC3B,GAC3B,GAAAY,ER02BA,OQ12BAA,GAAOZ,EAAE4R,IAAI2C,WAAW,GACnB3T,EAAL,IAAY,GAAPA,GAAkBA,EAAL,IAAY,IAAPA,IACxB4T,QAAQ,SAAArK,GR02BP,MQ12BO,UAACnK,GACR,GAAA6I,EACA,OADAsB,GAACW,KAAK9K,EAAE4R,KAAO5R,EAAE8T,OACH9T,EAAE8T,QR82B0B,OAAhCjL,EAAMsB,EAAM8I,SAASjT,EAAE4R,MAAgB/I,EQ72B/B4L,QAAQ,SAACxL,GR82BvB,MQ92B+BA,OADnC,SAFOjE,OAKT2N,GAAW,EAAG,GAEdI,EAAa,SAAA5I,GRg3BX,MQh3BW,UAAC0E,GACZ,GAAAoE,ER63BE,OQ73BFA,MACAN,EAAQ8B,QAAQ,SAACzU,GRk3Bb,MQl3BkBiT,GAASjT,QAC/BkU,MAAMC,gBAAgBhK,EAACuI,WAAY7D,GAChClN,OAAO,SAAC3B,GAAK,GAAA6I,ERo3BZ,OAAOA,GQp3BK7I,EAAE0U,OAAFlC,EAAAzR,KAAY4R,EAAZ9J,IAAA,IACb2L,QAAQ,SAACxU,GRq3BR,MQr3BaiT,GAASjT,EAAE0U,QAAQD,QAAQ,SAACxL,GRs3BvC,MQt3B4CA,GAAEjJ,EAAE2U,QAAS3U,EAAE4U,cAE/D,SAACC,EAAKC,GAAM,GAAAjM,ER03BR,OAAgC,QAAxBA,EAAMoK,EAAS4B,IAAgBhM,EQ13BhB/G,KAAKgT,GAApB,QACZ,SAACD,EAAKC,GR23BF,MQ33BQC,GAAEC,OAAO/B,EAAS4B,GAAM,SAAC5L,GAAK,MAAG,OAAA6L,EAAS7L,IAAK6L,GAAQ,QAR1D9P,MAWb6D,EAAgCkK,EAAW,aAA1C/N,KAACiQ,YAAApM,EAAA,GAAa7D,KAACkQ,aAAArM,EAAA,GAChBC,EAA4BiK,EAAW,WAAtC/N,KAACmQ,UAAArM,EAAA,GAAW9D,KAACoQ,WAAAtM,EAAA,GACdC,EAAoCgM,EAAEM,UAAUtC,EAAW,YAAa,SAAClR,EAAK7B,GRo4B5E,MQp4BiF6B,GAAIC,KAAK9B,EAAE4L,KAAK5G,KAAG,MAArGA,KAACsQ,cAAAvM,EAAA,GAAe/D,KAACuQ,eAAAxM,EAAA,GAElBC,EAAmC,SAAAmB,GRq4BjC,MQr4BiC,YACjC,GAAAqL,GAAAvC,EAAAwC,EAAAC,CRq6BE,OQr6BFzC,MACAuC,KACA7C,EAAQ8B,QAAQ,SAACzU,GRw4Bb,MQv4BFwV,GAAOxV,IAAK,EACZiT,EAASjT,QACXyV,EAAKvB,MAAMC,gBAAgBhK,EAACuI,WAAY,aAAa0B,IAAI,SAACpU,GRw4BtD,OQx4B4DA,EAAE0U,QAAQ,KAC1EgB,EAAKxB,MAAMC,gBAAgBhK,EAACuI,WAAY,WAAW0B,IAAI,SAACpU,GR04BpD,OQ14B0DA,EAAE0U,QAAQ,KACxEe,EAAGnB,MAAMoB,GAAIlB,QAAQ,SAACxU,GAAK,MAAuB,OAAAwV,EAAAxV,EAAA,IAAvBwV,EAAOxV,EAAE,IAAMA,EAAE,GAAjB,SAC3BkU,MAAMC,gBAAgBhK,EAACuI,WAAY,aAAa8B,QAAQ,SAACxU,GACvD,GAAAsI,GAAAsE,EAAA3D,CAAA2D,KRi5BE,KQj5BFtE,IAAA2K,GRk5BSpB,EAAQ9Q,KAAKkS,EAAU3K,KAC5BW,EAAIgK,EAAS3K,GACbsE,EAAQ9K,KQn5BVmH,EAAEwL,QAAQ,SAACnU,GAAK,MAA0BkV,GAAOlN,GAAjChI,EAAEN,EAAE2U,QAAS3U,EAAE4U,SAAf,URy5BhB,OAAOhI,MQv5BT,SAACiI,EAAKC,GAAM,GAAA9L,ER45BR,OAAiC,QAAzBA,EAAOiK,EAAS4B,IAAgB7L,EQ55BjBlH,KAAKgT,GAApB,QACZ,SAACD,EAAKC,GR65BF,MQ75BQC,GAAEC,OAAO/B,EAAS4B,GAAM,SAAC5L,GAAK,MAAG,OAAA6L,EAAS7L,IAAK6L,GAAQ,QAdpC9P,QAAlCA,KAAC2Q,YAAA3M,EAAA,GAAahE,KAAC4Q,aAAA5M,EAAA,GAiBhBhE,KAACwG,OAAS,SAAArB,GRs6BR,MQt6BQ,YR66BN,MQ56BFwI,GAAQ8B,QAAQ,SAACxL,GRy6Bb,MQx6BFkB,GAAC+K,aAAajM,GACdkB,EAACiL,WAAWnM,GACZkB,EAACyL,aAAa3M,KAChBkB,EAACoL,iBACDpL,EAAC8I,cANOjO,MR+7BZ,MAbAuC,GAAMlE,UQz6BNqD,GAAI,SAACkL,EAAKkD,GACR,MAAiC9P,MAACiO,SAASrB,GAApC5M,KAACiO,SAASrB,GAAK9P,KAAKgT,GAC3B9P,KAACiO,SAASrB,IAAQkD,IR86BpBvN,EAAMlE,UQ56BNwD,IAAK,SAAC+K,EAAKkD,GR66BT,MQ56BAC,GAAEC,OAAOhQ,KAACiO,SAASrB,GAAM,SAAC3I,GR66BxB,MQ76B6BA,KAAK6L,KRi7B/BvN,KQ96BTrG,EAAOJ,QAAUyG,ORq7BXsO,GAAG,SAASrV,EAAQU,EAAOJ,GSxgCjC,YAAA,IAAAgV,GAAAC,EAAApO,CAEAoO,GAAOvV,EAAQ,UACfmH,EAAQnH,EAAQ,WAEVsV,EAAA,WACS,QAAAA,KACX9Q,KAACgR,KAAO,GAAID,GACZ/Q,KAACiR,MAAY,GAAAtO,GAAM3C,KAACgR,KAAKnO,UAAW7C,KAACgR,KAAK5M,MT2hC5C,MAbA0M,GAAKzS,US5gCL6S,KAAM,WTkhCJ,MSjhCAC,uBAAsB,SAAAhM,GT6gCpB,MS7gCoB,YT8gClB,MS9gCqBA,GAAC+L,SAAJlR,OACtBA,KAACgR,KAAKI,OAAO,SAAAjM,GTihCX,MSjhCW,YTkhCT,MSlhCYA,GAAC8L,MAAMlG,WAAV/K,QTuhCR8Q,KSrhCTO,EAAE,WT0hCA,OS1hCM,GAAIP,IAAO,WT8hChBQ,UAAU,EAAEC,SAAS,KAAKC,IAAI,SAAShW,EAAQU,EAAOJ,GU3iCzD,GAAA2G,EAAMA,GAAA,WACS,QAAAA,GAACgP,EAAKxO,EAAOmF,EAAQ7B,GAApBvG,KAACyR,GAADA,EAAKzR,KAACiD,KAADA,EAAOjD,KAACoI,MAADA,EAAQpI,KAACuG,MAAA,MAAAA,EAADA,EAAS,IACzCvG,KAACkH,SVukCH,MAlBAzE,GAAKpE,UUnjCLiI,YAAa,SAACoL,GVujCZ,MUtjCA1R,MAACuG,OAASmL,EACV1R,KAACuG,MAAQvH,KAAK2S,IAAI,EAAG3R,KAACuG,OACtBvG,KAACgK,WAAWzB,KAAO,GAAGvI,KAACuG,MACvBvG,KAACiK,oBVsjCHxH,EAAKpE,UUpjCLuT,YAAa,SAAClW,GACZ,GAAAD,GAAAsE,EAAA8D,EAAA+D,EAAAtM,CVujCA,KUvjCAuI,EAAA7D,KAAAkH,MAAAU,KAAAnM,EAAA,EAAAsE,EAAA8D,EAAA7H,OAAA+D,EAAAtE,EAAAA,IVwjCEH,EAAIuI,EAAIpI,GACRmM,EAAQ9K,KUzjCVpB,EAAEJ,GV2jCF,OAAOsM,IAGFnF,KU5jCTvG,EAAOJ,QAAU2G,OVmkCXoP,IAAI,SAASrW,EAAQU,EAAOJ,GWjlClC,GAAAwQ,GAAA5J,CAAA4J,GAAS9Q,EAAQ,aAEXkH,EAAA,WACS,QAAAA,GAACqC,EAAO+M,GAAP9R,KAAC+E,KAADA,EAAO/E,KAAC8R,MAADA,EACnB9R,KAAC8G,KAAO5C,EAAG,EAAGC,EAAG,GACjBnE,KAACgH,IAAM,EACPhH,KAAC+R,QAAU,EACX/R,KAACoE,KAAO,GACRpE,KAACiI,IAAM,EXsqCT,MA1EAvF,GAAKrE,UW1lCLwJ,YAAa,WACX,GAAAmK,GAAArK,CX4mCA,OW5mCAqK,MACArK,EAAM3H,KAACgH,IAAMhI,KAAK8I,GAAK,IACvBkK,EAAMlV,MACJoH,EAAGlE,KAAC8G,IAAI5C,EAAIlE,KAACoE,KAAOpF,KAAK+I,IAAIJ,GAC7BxD,EAAGnE,KAAC8G,IAAI3C,EAAInE,KAACoE,KAAOpF,KAAKgJ,IAAIL,KAW/BqK,GXgmCFtP,EAAKrE,UW9lCL4T,OAAQ,SAACC,GACP,GAAAC,GAAAC,EAAAC,EAAA5W,EAAAsE,EAAAuS,EAAAC,CAIA,KAJAD,EAAW,EACXF,GAAU,EACVG,GAAW,EACXF,GAAQ,OAAW,IAAK,GAAI,OAAW,IAAK,KAAM,IAAK,IAAK,EAAG,IAAK,GAAI,EAAG,OAAW,IAAK,GAAI,QAC/F5W,EAAA,EAAAsE,EAAAmS,EAAAlW,OAAA+D,EAAAtE,EAAAA,IACE,OX+lCA0W,EAAMD,EAAQzW,IW/lCd,IACO6Q,GAAOX,KAAKC,IACf0G,GAAY,CADT,MADP,KAGOhG,GAAOX,KAAKE,OACfyG,GAAY,CADT,MAHP,KAKOhG,GAAOX,KAAKG,KACfwG,GAAY,CADT,MALP,KAOOhG,GAAOX,KAAKI,MACfuG,GAAY,CADT,MAPP,KASOhG,GAAON,OAAOC,IACjBmG,GAAU,EACVG,GAAW,CAFR,MATP,KAYOjG,GAAON,OAAOE,OACjBqG,GAAW,EAOjB,MANG,OAAAF,EAAAC,IACDtS,KAACgH,IAAMqL,EAAKC,GACZtS,KAACiI,IAASmK,EAAa,IAAU,KAEjCpS,KAACiI,IAAM,EAENsK,EACD,EADF,QX4mCF7P,EAAKrE,UWzmCL0M,OAAQ,WACN,GAAApD,EAMA,OANA3H,MAACiS,OAAOjS,KAAC8R,MAAM/G,OAAO/K,OAEtB2H,EAAM3H,KAACgH,IAAMhI,KAAK8I,GAAK,IACvB9H,KAAC8G,IAAI5C,GAAKlE,KAACiI,IAAMjJ,KAAK+I,IAAIJ,GAC1B3H,KAAC8G,IAAI3C,GAAKnE,KAACiI,IAAMjJ,KAAKgJ,IAAIL,GAC1B3H,KAACiI,IAAa,GAAPjI,KAACiI,IACMjI,KAACiI,IAAMjI,KAACiI,IAAM,KAA5BjI,KAACiI,IAAM,EAAP,QX8mCKvF,KW3mCTxG,EAAOJ,QAAU4G,IXknCd8P,YAAY,IAAIC,IAAI,SAASjX,EAAQU,EAAOJ,GYrrC/C,GAAA4W,EAAMA,GAAA,WZyrCJ,QAASA,MAkBT,MY1sCAA,GAACC,KAAO,SAACzX,GZ2rCP,MY1rCA8D,MAAKuI,MAAMvI,KAAK4T,SAAW1X,IAE7BwX,EAAC3L,MAAQ,SAAC7L,GZ4rCR,MY3rCA8D,MAAK4T,SAAW1X,GAElBwX,EAACG,UAAY,SAAC5T,EAAK0S,GZ6rCjB,MY5rCA3S,MAAKuI,MAAMvI,KAAK4T,UAAYjB,EAAM1S,EAAM,IAAMA,GAEhDyT,EAACrF,UAAY,SAAC1O,GZ8rCZ,MY7rCAA,GAAIK,KAAKuI,MAAMvI,KAAK4T,SAAWjU,EAAI3C,UZgsC9B0W,KY7rCTxW,EAAOJ,QAAU4W,OZosCXvE,IAAI,SAAS3S,EAAQU,EAAOJ,GaltClC,GAAAiV,EAAMA,GAAA,WACS,QAAAA,KAEX/Q,KAACoE,KAAO,IAERpE,KAAC8S,SAAWtK,KAAKuK,mBAAmB/S,KAACoE,KAAMpE,KAACoE,MACxC4O,gBAAiB,EACjBC,WAAW,IAEf5B,EAAErD,SAASkF,MAAMC,OAAOnT,KAAC8S,SAAS9B,MAElChR,KAAC6C,UAAY,GAAI2F,MAAK4K,UAEtBpT,KAACqT,MAAQ,GAAIC,OACbtT,KAACqT,MAAME,QAAQ,GACfvT,KAACqT,MAAM3F,WAAW8F,MAAM5K,SAAW,WACnC5I,KAACqT,MAAM3F,WAAW8F,MAAMC,MAAQ,MAChCzT,KAACqT,MAAM3F,WAAW8F,MAAME,IAAM,MAC9BrC,EAAErD,SAASkF,MAAMC,OAAOnT,KAACqT,MAAM3F,Yb2tCjC,MAPAqD,GAAK1S,UaltCL+S,OAAQ,SAACuC,GbstCP,MartCA3T,MAACqT,MAAMO,QACPD,IACA3T,KAAC8S,SAAS1B,OAAOpR,KAAC6C,WAClB7C,KAACqT,MAAMxU,ObqtCFkS,KaltCT7U,EAAOJ,QAAUiV,YbytCN","file":"bundle.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})",null,"// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n// resolves . and .. elements in a path array with directory names there\n// must be no slashes, empty elements, or device names (c:\\) in the array\n// (so also no leading and trailing slashes - it does not distinguish\n// relative and absolute paths)\nfunction normalizeArray(parts, allowAboveRoot) {\n  // if the path tries to go above the root, `up` ends up > 0\n  var up = 0;\n  for (var i = parts.length - 1; i >= 0; i--) {\n    var last = parts[i];\n    if (last === '.') {\n      parts.splice(i, 1);\n    } else if (last === '..') {\n      parts.splice(i, 1);\n      up++;\n    } else if (up) {\n      parts.splice(i, 1);\n      up--;\n    }\n  }\n\n  // if the path is allowed to go above the root, restore leading ..s\n  if (allowAboveRoot) {\n    for (; up--; up) {\n      parts.unshift('..');\n    }\n  }\n\n  return parts;\n}\n\n// Split a filename into [root, dir, basename, ext], unix version\n// 'root' is just a slash, or nothing.\nvar splitPathRe =\n    /^(\\/?|)([\\s\\S]*?)((?:\\.{1,2}|[^\\/]+?|)(\\.[^.\\/]*|))(?:[\\/]*)$/;\nvar splitPath = function(filename) {\n  return splitPathRe.exec(filename).slice(1);\n};\n\n// path.resolve([from ...], to)\n// posix version\nexports.resolve = function() {\n  var resolvedPath = '',\n      resolvedAbsolute = false;\n\n  for (var i = arguments.length - 1; i >= -1 && !resolvedAbsolute; i--) {\n    var path = (i >= 0) ? arguments[i] : process.cwd();\n\n    // Skip empty and invalid entries\n    if (typeof path !== 'string') {\n      throw new TypeError('Arguments to path.resolve must be strings');\n    } else if (!path) {\n      continue;\n    }\n\n    resolvedPath = path + '/' + resolvedPath;\n    resolvedAbsolute = path.charAt(0) === '/';\n  }\n\n  // At this point the path should be resolved to a full absolute path, but\n  // handle relative paths to be safe (might happen when process.cwd() fails)\n\n  // Normalize the path\n  resolvedPath = normalizeArray(filter(resolvedPath.split('/'), function(p) {\n    return !!p;\n  }), !resolvedAbsolute).join('/');\n\n  return ((resolvedAbsolute ? '/' : '') + resolvedPath) || '.';\n};\n\n// path.normalize(path)\n// posix version\nexports.normalize = function(path) {\n  var isAbsolute = exports.isAbsolute(path),\n      trailingSlash = substr(path, -1) === '/';\n\n  // Normalize the path\n  path = normalizeArray(filter(path.split('/'), function(p) {\n    return !!p;\n  }), !isAbsolute).join('/');\n\n  if (!path && !isAbsolute) {\n    path = '.';\n  }\n  if (path && trailingSlash) {\n    path += '/';\n  }\n\n  return (isAbsolute ? '/' : '') + path;\n};\n\n// posix version\nexports.isAbsolute = function(path) {\n  return path.charAt(0) === '/';\n};\n\n// posix version\nexports.join = function() {\n  var paths = Array.prototype.slice.call(arguments, 0);\n  return exports.normalize(filter(paths, function(p, index) {\n    if (typeof p !== 'string') {\n      throw new TypeError('Arguments to path.join must be strings');\n    }\n    return p;\n  }).join('/'));\n};\n\n\n// path.relative(from, to)\n// posix version\nexports.relative = function(from, to) {\n  from = exports.resolve(from).substr(1);\n  to = exports.resolve(to).substr(1);\n\n  function trim(arr) {\n    var start = 0;\n    for (; start < arr.length; start++) {\n      if (arr[start] !== '') break;\n    }\n\n    var end = arr.length - 1;\n    for (; end >= 0; end--) {\n      if (arr[end] !== '') break;\n    }\n\n    if (start > end) return [];\n    return arr.slice(start, end - start + 1);\n  }\n\n  var fromParts = trim(from.split('/'));\n  var toParts = trim(to.split('/'));\n\n  var length = Math.min(fromParts.length, toParts.length);\n  var samePartsLength = length;\n  for (var i = 0; i < length; i++) {\n    if (fromParts[i] !== toParts[i]) {\n      samePartsLength = i;\n      break;\n    }\n  }\n\n  var outputParts = [];\n  for (var i = samePartsLength; i < fromParts.length; i++) {\n    outputParts.push('..');\n  }\n\n  outputParts = outputParts.concat(toParts.slice(samePartsLength));\n\n  return outputParts.join('/');\n};\n\nexports.sep = '/';\nexports.delimiter = ':';\n\nexports.dirname = function(path) {\n  var result = splitPath(path),\n      root = result[0],\n      dir = result[1];\n\n  if (!root && !dir) {\n    // No dirname whatsoever\n    return '.';\n  }\n\n  if (dir) {\n    // It has a dirname, strip trailing slash\n    dir = dir.substr(0, dir.length - 1);\n  }\n\n  return root + dir;\n};\n\n\nexports.basename = function(path, ext) {\n  var f = splitPath(path)[2];\n  // TODO: make this comparison case-insensitive on windows?\n  if (ext && f.substr(-1 * ext.length) === ext) {\n    f = f.substr(0, f.length - ext.length);\n  }\n  return f;\n};\n\n\nexports.extname = function(path) {\n  return splitPath(path)[3];\n};\n\nfunction filter (xs, f) {\n    if (xs.filter) return xs.filter(f);\n    var res = [];\n    for (var i = 0; i < xs.length; i++) {\n        if (f(xs[i], i, xs)) res.push(xs[i]);\n    }\n    return res;\n}\n\n// String.prototype.substr - negative index don't work in IE8\nvar substr = 'ab'.substr(-1) === 'b'\n    ? function (str, start, len) { return str.substr(start, len) }\n    : function (str, start, len) {\n        if (start < 0) start = str.length + start;\n        return str.substr(start, len);\n    }\n;\n","// shim for using process in browser\n\nvar process = module.exports = {};\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = setTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    clearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        setTimeout(drainQueue, 0);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n","path = require 'path'\r\nfs = require 'fs'\r\n\r\nutil = require './util'\r\nInput = require './input'\r\nUnit = require './unit'\r\nTeam = require './team'\r\nHumanBrain = require './brain/human'\r\nStandardBrain = require './brain/standard'\r\n\r\n\r\nclass World\r\n\r\n  constructor: (@container, @viewsize, @size = 32)->\r\n    @input = new Input\r\n    @size2 = @size * @size\r\n    @gridSize = @viewsize / @size\r\n\r\n    @field = new Uint8Array @size2\r\n    @dismap = new Int32Array @size2\r\n    @plInfmap = new Float32Array @size2\r\n    @enInfmap = new Float32Array @size2\r\n\r\n    playerTeam = 1\r\n    @team = []\r\n    base = [{}, {}]\r\n\r\n    mapstr = fs.readFileSync path.resolve(__dirname, '../content/data/field1.txt'), 'utf8'\r\n    mapstr = mapstr.replace /\\r*\\n/g, ''\r\n    for v, i in @field\r\n      @field[i] = parseInt mapstr.charAt(i)\r\n      x = i % @size\r\n      y = i / @size | 0\r\n      switch @field[i]\r\n        when 6 then base[0] = {x: x, y: y}\r\n        when 7 then base[1] = {x: x, y: y}\r\n\r\n    @team.push new Team(0, base[0], 0xffa000)\r\n    @team.push new Team(1, base[1], 0x00ffff)\r\n\r\n    for v, i in @dismap\r\n      @dismap[i] = if [0, 6, 7, 8].some((v)=> @field[i] is v) then 1 else -1\r\n\r\n    @gField = @setupField()\r\n    @container.addChild @gField\r\n    \r\n    humanBrain = new HumanBrain @input\r\n    @player = new Unit playerTeam, humanBrain\r\n    @addUnit @player\r\n\r\n    for t, i in @team\r\n      memberNum = if playerTeam is i then 3 else 4\r\n      for k in [0...memberNum]\r\n        b = new StandardBrain\r\n        u = new Unit i, b\r\n        @addUnit u\r\n\r\n\r\n    gStart = @setupStartView()\r\n    @container.addChild gStart\r\n\r\n    gPause = @setupPauseView()\r\n\r\n    @scene = {}\r\n    @scene.init = =>\r\n      (transit)=>\r\n        if @input.keys['z']\r\n          @container.removeChild gStart\r\n          transit 'main'\r\n    \r\n    @scene.main = =>\r\n      pause = false\r\n      @input.on 'space', =>\r\n        pause = not pause\r\n        if pause\r\n          @container.addChild gPause\r\n        else\r\n          @container.removeChild gPause\r\n      (transit)=>\r\n        return if pause\r\n        @updateUnits()\r\n        @team[0].changePoint -100 if @input.keys['o'] # debug\r\n        @team[1].changePoint -100 if @input.keys['p'] # debug\r\n\r\n        result = undefined\r\n        for t, i in @team\r\n          if t.point is 0\r\n            result = if i is playerTeam then false else true\r\n            break\r\n\r\n        if result isnt undefined\r\n          @input.offAll()\r\n          gResult = @setupResultView result\r\n          @container.addChild gResult\r\n          transit 'result'\r\n    \r\n    @scene.result = =>\r\n      (transit)->\r\n\r\n    @phase = null\r\n    @transit = (next)=> @phase = @scene[next]().bind @, @transit\r\n\r\n    @transit 'init'\r\n\r\n\r\n  addUnit: (u)->\r\n    t = u.team\r\n    {x, y} = @team[t].base\r\n    u.pos.x = x + util.randf 1\r\n    u.pos.y = y + util.randf 1\r\n    u.ang = if t % 2 then 180 else 0\r\n    g = @setupUnit u\r\n    @container.addChild g\r\n    @team[t].units.push\r\n      i: u\r\n      g: g\r\n\r\n  hitCheck: (x, y)->\r\n    return -2 if x < 0.5 or y < 0.5\r\n    return -2 if x > @size - 0.5 or y > @size - 0.5\r\n    index = Math.floor(x - 0.5) + @size * Math.floor(y - 0.5)\r\n    rx = x - 0.5 - Math.floor(x - 0.5)\r\n    ry = y - 0.5 - Math.floor(y - 0.5)\r\n    rx = 0 if rx < 0.0001\r\n    ry = 0 if ry < 0.0001\r\n    d = [\r\n      @dismap[index],\r\n      @dismap[index + 1],\r\n      @dismap[index + @size],\r\n      @dismap[index + @size + 1]\r\n    ]\r\n    return (1 - rx) * (1 - ry) * d[0] + (1 - rx) * ry * d[2] + rx * (1 - ry) * d[1] + rx * ry * d[3]\r\n    \r\n  fix: (unit)->\r\n    poss = unit.getCollider()\r\n    for p in poss\r\n      d = @hitCheck p.x, p.y\r\n      if d < 0\r\n        rad = (unit.ang + 180) * Math.PI / 180\r\n        unit.pos.x -= d * Math.cos rad\r\n        unit.pos.y -= d * Math.sin rad\r\n        unit.vel = 0.0\r\n\r\n  setupText: (x, y, str, font, color, stylex, styley)->\r\n    text = new PIXI.Text str,\r\n      font: font\r\n      fill: color\r\n      align: stylex\r\n    switch stylex\r\n      when 'center'\r\n        text.position.x = x - text.width / 2\r\n      when 'right'\r\n        text.position.x = x - text.width\r\n    switch styley\r\n      when 'center'\r\n        text.position.y = y - text.height / 2\r\n      when 'bottom'\r\n        text.position.y = y - text.height\r\n    return text\r\n\r\n  setupStartView: ->\r\n    g = new PIXI.Graphics\r\n    g.lineStyle 0\r\n      .beginFill 0x333333\r\n      .drawRect 0, 0, @viewsize, @viewsize\r\n      .endFill()\r\n    g.alpha = 0.7\r\n\r\n    text = @setupText @viewsize / 2, @viewsize / 2, 'PRESS Z', '24px Papyrus', 0xffffff, 'center', 'center'\r\n    g.addChild text\r\n\r\n    return g\r\n\r\n  setupPauseView: ->\r\n    g = new PIXI.Graphics\r\n    g.lineStyle 0\r\n      .beginFill 0x333333\r\n      .drawRect 0, 0, @viewsize, @viewsize\r\n      .endFill()\r\n    g.alpha = 0.7\r\n\r\n    text = @setupText @viewsize / 2, @viewsize / 2, 'Pause', '24px Papyrus', 0xffffff, 'center', 'center'\r\n    g.addChild text\r\n\r\n    return g\r\n\r\n  setupResultView: (isWin)->\r\n    g = new PIXI.Graphics\r\n    g.lineStyle 0\r\n      .beginFill 0x333333\r\n      .drawRect 0, 0, @viewsize, @viewsize\r\n      .endFill()\r\n    g.alpha = 0.7\r\n    col = if isWin then 0xffff00 else 0x00ffff\r\n    str = if isWin then 'You Win' else 'You Lose'\r\n    text = @setupText @viewsize / 2, @viewsize / 2, str, '36px Papyrus', col, 'center', 'center'\r\n    g.addChild text\r\n\r\n    text2 = @setupText @viewsize / 2, @viewsize * 3 / 4, 'PRESS ESC or Reload', '16px Papyrus', 0xffffff, 'center', 'bottom'\r\n    g.addChild text2\r\n    \r\n    return g\r\n\r\n  setupField: ->\r\n    g = new PIXI.Graphics\r\n    g2 = new PIXI.Graphics\r\n    filter = new PIXI.filters.BlurFilter\r\n    filter.blur = 7\r\n\r\n    draw = (type, width, color)=>\r\n      \r\n      for v, i in @dismap\r\n        x = i % @size\r\n        y = i / @size | 0\r\n        continue if x > @size - 2\r\n        break if y > @size - 2 \r\n        d = [@dismap[i], @dismap[i + 1], @dismap[i + @size], @dismap[i + @size + 1]]\r\n        f = [@field[i], @field[i + 1], @field[i + @size], @field[i + @size + 1]]\r\n      \r\n        continue unless f.some((v)-> v is type)\r\n      \r\n        p = []\r\n        p.push {x: x + 0.5, y: y} if d[0] * d[1] < 0\r\n        p.push {x: x, y: y + 0.5} if d[0] * d[2] < 0\r\n        p.push {x: x + 1.0, y: y + 0.5} if d[1] * d[3] < 0\r\n        p.push {x: x + 0.5, y: y + 1.0} if d[2] * d[3] < 0\r\n        continue unless p.length is 2\r\n        \r\n        g.lineStyle width, color\r\n          .moveTo (p[0].x + 0.5) * @gridSize, (p[0].y + 0.5) * @gridSize\r\n          .lineTo (p[1].x + 0.5) * @gridSize, (p[1].y + 0.5) * @gridSize\r\n\r\n        g2.lineStyle width * 2, color\r\n          .moveTo (p[0].x + 0.5) * @gridSize, (p[0].y + 0.5) * @gridSize\r\n          .lineTo (p[1].x + 0.5) * @gridSize, (p[1].y + 0.5) * @gridSize\r\n\r\n    draw 1, 2, 0x00ff7f\r\n    draw 2, 2, 0xff7f00\r\n    draw 3, 2, 0xff3000\r\n    draw 4, 2, 0x00a0ff\r\n    draw 5, 2, 0x0050ff\r\n\r\n    for t in @team\r\n      str = \"#{t.point}\"\r\n      col = 0xffffff\r\n      x = (t.base.x + 0.5) * @gridSize\r\n      y = (t.base.y + 0.5) * @gridSize\r\n      t.scoreborad = @setupText x, y, str, '36px Papyrus', col, 'center', 'center'\r\n      t.scoreborad.alpha = 0.7\r\n      t.scoreboradUpdate = do =>\r\n        gs = @gridSize\r\n        ->\r\n          x = (@base.x + 0.5) * gs\r\n          y = (@base.y + 0.5) * gs\r\n          @scoreborad.position.x = x - @scoreborad.width / 2\r\n          @scoreborad.position.y = y - @scoreborad.height / 2\r\n        \r\n      g.addChild t.scoreborad\r\n\r\n    g.blendMode = PIXI.BLEND_MODES.ADD\r\n    g.alpha = 0.7\r\n    g2.alpha = 0.3\r\n    g2.filters = [filter]\r\n\r\n    g.addChild g2\r\n\r\n    return g\r\n\r\n  setupUnit: (unit)->\r\n    g = new PIXI.Graphics\r\n    \r\n    p0x = unit.pos.x * @gridSize\r\n    p0y = unit.pos.y * @gridSize\r\n    size = unit.size * @gridSize\r\n\r\n    p1x = size\r\n    p1y = 0\r\n\r\n    rad = -150 * Math.PI / 180\r\n    p2x = size * Math.cos rad\r\n    p2y = size * Math.sin rad\r\n\r\n    rad = 150 * Math.PI / 180\r\n    p3x = size * Math.cos rad\r\n    p3y = size * Math.sin rad\r\n    \r\n    g.lineStyle 2, @team[unit.team].color\r\n      .moveTo p1x, p1y\r\n      .lineTo p2x, p2y\r\n      .lineTo 0, 0\r\n      .lineTo p3x, p3y\r\n      .lineTo p1x, p1y\r\n\r\n    g.position.x = p0x\r\n    g.position.y = p0y \r\n\r\n    return g\r\n\r\n  updateUnits: ->\r\n    for t in @team\r\n      for u in t.units\r\n        u.i.update()\r\n        @fix u.i\r\n        u.g.position.x = u.i.pos.x * @gridSize\r\n        u.g.position.y = u.i.pos.y * @gridSize\r\n        u.g.rotation = u.i.ang * Math.PI / 180\r\n\r\n  update: ->\r\n    location.reload() if @input.keys['esc']\r\n    @phase()\r\n\r\nmodule.exports = World\r\n","module.exports = \r\n  IDOL: 0\r\n  MOVE:\r\n    TOP:    1\r\n    BOTTOM: 2\r\n    LEFT:   3\r\n    RIGHT:  4\r\n  ATTACK:\r\n    AIM:    5\r\n    FOWARD: 6","class Brain\r\n  constructor: ()->\r\n\r\n\r\n  update: (unit)->\r\n\r\n\r\nmodule.exports = Brain\r\n","Brain = require '../brain'\r\nACTION = require '../actions'\r\n\r\nclass HumanBrain extends Brain\r\n  constructor: (@input)->\r\n    super()\r\n\r\n\r\n  update: (unit)->\r\n    super unit\r\n    acts = []  \r\n\r\n    if @input.keys['up']\r\n      acts.push ACTION.MOVE.TOP\r\n    if @input.keys['down']\r\n      acts.push ACTION.MOVE.BOTTOM\r\n    if @input.keys['right']\r\n      acts.push ACTION.MOVE.RIGHT\r\n    if @input.keys['left']\r\n      acts.push ACTION.MOVE.LEFT\r\n    if @input.keys['z']\r\n      acts.push ACTION.ATTACK.AIM\r\n      \r\n    \r\n    acts\r\n\r\nmodule.exports = HumanBrain","util = require '../util'\r\nBrain = require '../brain'\r\nACTION = require '../actions'\r\n\r\nclass StandardBrain extends Brain\r\n  constructor: ()->\r\n    super()\r\n\r\n\r\n  update: (unit)->\r\n    super unit\r\n    acts = []  \r\n\r\n    acts.push util.randArray([\r\n      ACTION.MOVE.TOP, \r\n      ACTION.MOVE.BOTTOM, \r\n      ACTION.MOVE.LEFT, \r\n      ACTION.MOVE.RIGHT\r\n    ])\r\n    \r\n    return acts\r\n\r\nmodule.exports = StandardBrain","class Input\r\n  constructor: (@domElement = document)->\r\n    @keys = {}\r\n    @listener = {}\r\n\r\n    @keyMap =\r\n      8: 'backspace'\r\n      13: 'enter'\r\n      16: 'shift'\r\n      17: 'ctrl'\r\n      18: 'alt'\r\n      27: 'esc'\r\n      32: 'space'\r\n      37: 'left'\r\n      38: 'up'\r\n      39: 'right'\r\n      40: 'down'\r\n\r\n    mapper = (keycode, status)=>\r\n      key: @keyMap[keycode] or String.fromCharCode(keycode).toLowerCase()\r\n      status: status\r\n\r\n    keydown = Bacon.fromEventTarget(@domElement, 'keydown').map (e)=> mapper.call @, e.keyCode, true\r\n    keyup = Bacon.fromEventTarget(@domElement, 'keyup').map (e)=> mapper.call @, e.keyCode, false\r\n    keydown.merge(keyup).filter (e)->\r\n      code = e.key.charCodeAt 0\r\n      47 < code < 58 or 96 < code < 123\r\n    .onValue (e)=>\r\n      @keys[e.key] = e.status\r\n      return unless e.status \r\n      @listener[e.key]?.forEach (v)-> do v\r\n\r\n    buttons = [1, 2]\r\n    \r\n    mouseEvent = (type)=>\r\n      listener = {}\r\n      buttons.forEach (e)-> listener[e] = []\r\n      Bacon.fromEventTarget @domElement, type\r\n        .filter (e)-> e.button in buttons\r\n        .onValue (e)-> listener[e.button].forEach (v)-> v e.clientX, e.clientY\r\n      [ \r\n        (btn, cb)-> listener[btn]?.push cb,\r\n        (btn, cb)-> _.remove listener[btn], (v)-> if cb? then v is cb else true\r\n      ]\r\n\r\n    [@onMouseDown, @offMouseDown] = mouseEvent 'mousedown'\r\n    [@onMouseUp, @offMouseUp] = mouseEvent 'mouseup'\r\n    [@onDoubleClick, @offDoubleClick] = _.transform mouseEvent('dblclick'), (res, e)-> res.push e.bind @, 1\r\n\r\n    [@onMouseMove, @offMouseMove] = do =>\r\n      listener = {}\r\n      active = {}\r\n      buttons.forEach (e)-> \r\n        active[e] = false\r\n        listener[e] = []\r\n      md = Bacon.fromEventTarget(@domElement, 'mousedown').map (e)-> [e.button, true]\r\n      mu = Bacon.fromEventTarget(@domElement, 'mouseup').map (e)-> [e.button, false]\r\n      md.merge(mu).onValue (e)-> active[e[0]] = e[1] if active[e[0]]?\r\n      Bacon.fromEventTarget(@domElement, 'mousemove').onValue (e)->\r\n        for own k, v of listener\r\n          v.forEach (u)-> u e.clientX, e.clientY if active[k] \r\n      [\r\n        (btn, cb)-> listener[btn]?.push cb,\r\n        (btn, cb)-> _.remove listener[btn], (v)-> if cb? then v is cb else true\r\n      ]\r\n\r\n    @offAll = =>\r\n      buttons.forEach (v)=>\r\n        @offMouseDown v\r\n        @offMouseUp v\r\n        @offMouseMove v\r\n      @offDoubleClick()\r\n      @listener = {}\r\n        \r\n\r\n  on: (key, cb)->\r\n    return @listener[key].push cb if @listener[key]\r\n    @listener[key] = [cb]\r\n\r\n  off: (key, cb)->\r\n    _.remove @listener[key], (v)-> v is cb\r\n\r\n\r\nmodule.exports = Input","'use strict'\r\n\r\nView = require './view'\r\nWorld = require './World'\r\n\r\nclass Main \r\n  constructor: ->\r\n    @view = new View\r\n    @world = new World @view.container, @view.size\r\n    \r\n  loop: ->\r\n    requestAnimationFrame => @loop()\r\n    @view.render => @world.update()\r\n\r\n$ -> do new Main().loop\r\n","\r\nclass Team\r\n  constructor: (@id, @base, @color, @point = 100)->\r\n    @units = []\r\n\r\n  changePoint: (diff)->\r\n    @point += diff\r\n    @point = Math.max 0, @point\r\n    @scoreborad.text = \"#{@point}\"\r\n    @scoreboradUpdate()\r\n\r\n  eachMembers: (f)->\r\n    f u for u in @units\r\n\r\nmodule.exports = Team","ACTION = require './actions'\r\n\r\nclass Unit \r\n  constructor: (@team, @brain)->\r\n    @pos = {x: 0, y: 0}\r\n    @ang = 0\r\n    @shotang = 0.0\r\n    @size = 0.2\r\n    @vel = 0.0\r\n\r\n  getCollider: ->\r\n    colls = []\r\n    rad = @ang * Math.PI / 180\r\n    colls.push\r\n      x: @pos.x + @size * Math.cos rad\r\n      y: @pos.y + @size * Math.sin rad\r\n    ###\r\n    rad = (@ang - 150) * Math.PI / 180\r\n    colls.push\r\n      x: @pos.x + @size * Math.cos rad\r\n      y: @pos.y + @size * Math.sin rad\r\n    rad = (@ang + 150) * Math.PI / 180\r\n    colls.push\r\n      x: @pos.x + @size * Math.cos rad\r\n      y: @pos.y + @size * Math.sin rad\r\n    ###\r\n    colls\r\n\r\n  action: (actions)->\r\n    moveflag = 0\r\n    aimflag = false\r\n    shotflag = false\r\n    angs = [undefined, -90, 90, undefined, 180, -135, 135, 180, 0, -45, 45, 0, undefined, -90, 90, undefined]\r\n    for act in actions\r\n      switch act\r\n        when ACTION.MOVE.TOP\r\n          moveflag += 1\r\n        when ACTION.MOVE.BOTTOM\r\n          moveflag += 2\r\n        when ACTION.MOVE.LEFT\r\n          moveflag += 4\r\n        when ACTION.MOVE.RIGHT\r\n          moveflag += 8  \r\n        when ACTION.ATTACK.AIM\r\n          aimflag = true\r\n          shotflag = true\r\n        when ACTION.ATTACK.FOWARD\r\n          shotflag = true\r\n    if angs[moveflag]?\r\n      @ang = angs[moveflag]\r\n      @vel = if aimflag then 0.04 else 0.07\r\n    else\r\n      @vel = 0\r\n\r\n    if shotflag\r\n      0 #TODO\r\n\r\n  update: ()->\r\n    @action @brain.update(@)\r\n\r\n    rad = @ang * Math.PI / 180\r\n    @pos.x += @vel * Math.cos rad\r\n    @pos.y += @vel * Math.sin rad\r\n    @vel = @vel * 0.7\r\n    @vel = 0.0 if @vel * @vel < 0.0001\r\n\r\n\r\nmodule.exports = Unit\r\n","class Utility\r\n  @rand = (n)->\r\n    Math.floor Math.random() * n\r\n\r\n  @randf = (n)->\r\n    Math.random() * n\r\n\r\n  @randRange = (min, max)->\r\n    Math.floor(Math.random() * (max - min + 1)) + min\r\n  \r\n  @randArray = (arr)->\r\n    arr[Math.floor Math.random() * arr.length]\r\n\r\n\r\nmodule.exports = Utility","class View\r\n  constructor: ->\r\n\r\n    @size = 640\r\n    \r\n    @renderer = PIXI.autoDetectRenderer @size, @size,\r\n        backgroundColor: 0x000000\r\n        antialias: true\r\n        #transparent: true\r\n    $(document.body).append @renderer.view\r\n\r\n    @container = new PIXI.Container\r\n\r\n    @stats = new Stats\r\n    @stats.setMode 0  # 0: fps, 1: ms, 2: mb\r\n    @stats.domElement.style.position = 'absolute'\r\n    @stats.domElement.style.right = '0px'\r\n    @stats.domElement.style.top = '0px'\r\n    $(document.body).append @stats.domElement\r\n\r\n  render: (updater)->\r\n    @stats.begin()\r\n    updater()\r\n    @renderer.render @container\r\n    @stats.end()\r\n\r\n\r\nmodule.exports = View\r\n"],"sourceRoot":"./src"}